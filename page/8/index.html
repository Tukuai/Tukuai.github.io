<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://tukuai.github.io/page/8/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Tukuai">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://Tukuai.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Web/JQuery基础" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/28/Web/JQuery%E5%9F%BA%E7%A1%80/" class="article-date">
  <time datetime="2020-03-28T02:02:14.000Z" itemprop="datePublished">2020-03-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/28/Web/JQuery%E5%9F%BA%E7%A1%80/">JQuery基础</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="JQuery-基础："><a href="#JQuery-基础：" class="headerlink" title="JQuery 基础："></a>JQuery 基础：</h1><h2 id="一、概念："><a href="#一、概念：" class="headerlink" title="一、概念："></a><strong>一、概念：</strong></h2><ul>
<li>一个JavaScript框架。简化JS开发</li>
<li>jQuery是一个快速、简洁的JavaScript框架，是继Prototype之后又一个优秀的JavaScript代码库（或JavaScript框架）。jQuery设计的宗旨是“write Less，Do More”，即倡导写更少的代码，做更多的事情。它封装JavaScript常用的功能代码，提供一种简便的JavaScript设计模式，优化HTML文档操作、事件处理、动画设计和Ajax交互。</li>
<li>JavaScript框架：本质上就是一些js文件，封装了js的原生代码而已</li>
</ul>
<h2 id="二、快速入门"><a href="#二、快速入门" class="headerlink" title="二、快速入门"></a><strong>二、快速入门</strong></h2><ol>
<li>步骤：<ol>
<li>下载JQuery<ul>
<li>目前jQuery有三个大版本：<br>  1.x：兼容ie678,使用最为广泛的，官方只做BUG维护，<pre><code>功能不再新增。因此一般项目来说，使用1.x版本就可以了，
最终版本：1.12.4 (2016年5月20日)</code></pre>  2.x：不兼容ie678，很少有人使用，官方只做BUG维护，<pre><code>功能不再新增。如果不考虑兼容低版本的浏览器可以使用2.x，
最终版本：2.2.4 (2016年5月20日)</code></pre>  3.x：不兼容ie678，只支持最新的浏览器。除非特殊要求，<pre><code>一般不会使用3.x版本的，很多老的jQuery插件不支持这个版本。
目前该版本是官方主要更新维护的版本。最新版本：3.2.1（2017年3月20日）</code></pre></li>
<li>jquery-xxx.js 与 jquery-xxx.min.js区别：<ol>
<li>jquery-xxx.js：开发版本。给程序员看的，有良好的缩进和注释。体积大一些</li>
<li>jquery-xxx.min.js：生产版本。程序中使用，没有缩进。体积小一些。程序加载更快</li>
</ol>
</li>
</ul>
</li>
<li>导入JQuery的js文件：导入min.js文件</li>
<li>使用<br> var div1 = $(“#div1”);<pre><code>alert(div1.html());</code></pre></li>
</ol>
</li>
</ol>
<h2 id="三、JQuery对象和JS对象区别与转换"><a href="#三、JQuery对象和JS对象区别与转换" class="headerlink" title="三、JQuery对象和JS对象区别与转换"></a><strong>三、JQuery对象和JS对象区别与转换</strong></h2><ol>
<li>JQuery对象在操作时，更加方便。</li>
<li>JQuery对象和js对象方法不通用的.</li>
<li>两者相互转换<ul>
<li>jq – &gt; js : jq对象[索引] 或者 jq对象.get(索引)</li>
<li>js – &gt; jq : $(js对象)</li>
</ul>
</li>
</ol>
<h2 id="四、选择器：筛选具有相似特征的元素-标签"><a href="#四、选择器：筛选具有相似特征的元素-标签" class="headerlink" title="四、选择器：筛选具有相似特征的元素(标签)"></a><strong>四、选择器：</strong>筛选具有相似特征的元素(标签)</h2><h3 id="1-基本操作学习："><a href="#1-基本操作学习：" class="headerlink" title="1.基本操作学习："></a><strong>1.基本操作学习：</strong></h3><ol>
<li>事件绑定<br> //1.获取b1按钮<br> $(“#b1”).click(function(){<pre><code>alert(&quot;abc&quot;);</code></pre> });</li>
<li>入口函数<br>  $(function () {          <pre><code>});</code></pre>  window.onload  和 $(function) 区别<pre><code>* window.onload 只能定义一次,如果定义多次，后边的会将前边的覆盖掉
* $(function)可以定义多次的。</code></pre></li>
<li>样式控制：css方法<br>  // $(“#div1”).css(“background-color”,”red”);<pre><code>$(&quot;#div1&quot;).css(&quot;backgroundColor&quot;,&quot;pink&quot;);</code></pre></li>
</ol>
<h3 id="2-分类"><a href="#2-分类" class="headerlink" title="2 分类"></a><strong>2 分类</strong></h3><ol>
<li>基本选择器<ol>
<li>标签选择器（元素选择器）<ul>
<li>语法： $(“html标签名”) 获得所有匹配标签名称的元素</li>
</ul>
</li>
<li>id选择器 <ul>
<li>语法： $(“#id的属性值”) 获得与指定id属性值匹配的元素</li>
</ul>
</li>
<li>类选择器<ul>
<li>语法： $(“.class的属性值”) 获得与指定的class属性值匹配的元素</li>
</ul>
</li>
<li>并集选择器：<ul>
<li>语法： $(“选择器1,选择器2….”) 获取多个选择器选中的所有元素、<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// &lt; input type="button" value="改变 id 为 one 的元素的背景色为 红色"  id="b1"/&gt;</span></span><br><span class="line">			$(<span class="string">"#b1"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">				$(<span class="string">"#one"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// &lt;input type="button" value=" 改变元素名为 &lt;div&gt; 的所有元素的背景色为 红色"  id="b2"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b2"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"div"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// &lt;input type="button" value=" 改变 class 为 mini 的所有元素的背景色为 红色"  id="b3"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b3"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">".mini"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// &lt;input type="button" value=" 改变所有的&lt;span&gt;元素和 id 为 two 的元素的背景色为红色"  id="b4"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b4"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"span,#two"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
</li>
<li>层级选择器<ol>
<li>后代选择器<ul>
<li>语法： $(“A B “) 选择A元素内部的所有B元素        </li>
</ul>
</li>
<li>子选择器<ul>
<li>语法： $(“A &gt; B”) 选择A元素内部的所有B子元素<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// &lt;input type="button" value=" 改变 &lt;body&gt; 内所有 &lt;div&gt; 的背景色为红色"  id="b1"/&gt;</span></span><br><span class="line">			$(<span class="string">"#b1"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">				$(<span class="string">"body div"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// &lt;input type="button" value=" 改变 &lt;body&gt; 内子 &lt;div&gt; 的背景色为 红色"  id="b2"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b2"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"body &gt; div"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
</li>
<li>属性选择器<ol>
<li>属性名称选择器 <ul>
<li>语法： $(“A[属性名]”) 包含指定属性的选择器</li>
</ul>
</li>
<li>属性选择器<ul>
<li>语法： $(“A[属性名=’值’]”) 包含指定属性等于指定值的选择器</li>
</ul>
</li>
<li>复合属性选择器<ul>
<li>语法： $(“A[属性名=’值’][]…”) 包含多个属性条件的选择器<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="comment">// &lt;input type="button" value=" 含有属性title 的div元素背景色为红色"  id="b1"/&gt;</span></span><br><span class="line">			$(<span class="string">"#b1"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">				$(<span class="string">"div[title]"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">			<span class="comment">// &lt;input type="button" value=" 属性title值等于test的div元素背景色为红色"  id="b2"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b2"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"div[title='test']"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">			<span class="comment">// &lt;input type="button" value=" 属性title值不等于test的div元素(没有属性title的也将被选中)背景色为红色"  id="b3"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b3"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"div[title!='test']"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">			<span class="comment">// &lt;input type="button" value=" 属性title值 以te开始 的div元素背景色为红色"  id="b4"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b4"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"div[title^='te']"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">			<span class="comment">// &lt;input type="button" value=" 属性title值 以est结束 的div元素背景色为红色"  id="b5"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b5"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"div[title$='est']"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">			<span class="comment">// &lt;input type="button" value="属性title值 含有es的div元素背景色为红色"  id="b6"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b6"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"div[title*='es']"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">			<span class="comment">// &lt;input type="button" value="选取有属性id的div元素，然后在结果中选取属性title值含有“es”的 div 元素背景色为红色"  id="b7"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b7"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"div[id][title*='es']"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
</li>
<li>过滤选择器<ol>
<li>首元素选择器 <ul>
<li>语法： :first 获得选择的元素中的第一个元素</li>
</ul>
</li>
<li>尾元素选择器 <ul>
<li>语法： :last 获得选择的元素中的最后一个元素</li>
</ul>
</li>
<li>非元素选择器<ul>
<li>语法： :not(selector) 不包括指定内容的元素</li>
</ul>
</li>
<li>偶数选择器<ul>
<li>语法： :even 偶数，从 0 开始计数</li>
</ul>
</li>
<li>奇数选择器<ul>
<li>语法： :odd 奇数，从 0 开始计数</li>
</ul>
</li>
<li>等于索引选择器<ul>
<li>语法： :eq(index) 指定索引元素</li>
</ul>
</li>
<li>大于索引选择器 <ul>
<li>语法： :gt(index) 大于指定索引元素</li>
</ul>
</li>
<li>小于索引选择器 <ul>
<li>语法： :lt(index) 小于指定索引元素</li>
</ul>
</li>
<li>标题选择器<ul>
<li>语法： :header 获得标题（h1~ h6）元素，固定写法<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// &lt;input type="button" value=" 改变第一个 div 元素的背景色为 红色"  id="b1"/&gt;</span></span><br><span class="line">			$(<span class="string">"#b1"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">				$(<span class="string">"div:first"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// &lt;input type="button" value=" 改变最后一个 div 元素的背景色为 红色"  id="b2"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b2"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"div:last"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// &lt;input type="button" value=" 改变class不为 one 的所有 div 元素的背景色为 红色"  id="b3"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b3"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"div:not(.one)"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// &lt;input type="button" value=" 改变索引值为偶数的 div 元素的背景色为 红色"  id="b4"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b4"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"div:even"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">// &lt;input type="button" value=" 改变索引值为奇数的 div 元素的背景色为 红色"  id="b5"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b5"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"div:odd"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// &lt;input type="button" value=" 改变索引值为大于 3 的 div 元素的背景色为 红色"  id="b6"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b6"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"div:gt(3)"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// &lt;input type="button" value=" 改变索引值为等于 3 的 div 元素的背景色为 红色"  id="b7"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b7"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"div:eq(3)"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// &lt;input type="button" value=" 改变索引值为小于 3 的 div 元素的背景色为 红色"  id="b8"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b8"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"div:lt(3)"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// &lt;input type="button" value=" 改变所有的标题元素的背景色为 红色"  id="b9"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b9"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">":header"</span>).css(<span class="string">"backgroundColor"</span>,<span class="string">"pink"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
</li>
<li>表单过滤选择器<ol>
<li>可用元素选择器 <ul>
<li>语法： :enabled 获得可用元素</li>
</ul>
</li>
<li>不可用元素选择器 <ul>
<li>语法： :disabled 获得不可用元素</li>
</ul>
</li>
<li>选中选择器 <ul>
<li>语法： :checked 获得单选/复选框选中的元素</li>
</ul>
</li>
<li>选中选择器 <ul>
<li>语法： :selected 获得下拉框选中的元素<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="comment">// &lt;input type="button" value=" 利用 jQuery 对象的 val() 方法改变表单内可用 &lt;input&gt; 元素的值"  id="b1"/&gt;</span></span><br><span class="line">			$(<span class="string">"#b1"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">				$(<span class="string">"input[type='text']:enabled"</span>).val(<span class="string">"aaa"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">			<span class="comment">// &lt;input type="button" value=" 利用 jQuery 对象的 val() 方法改变表单内不可用 &lt;input&gt; 元素的值"  id="b2"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b2"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                $(<span class="string">"input[type='text']:disabled"</span>).val(<span class="string">"aaa"</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">			<span class="comment">// &lt;input type="button" value=" 利用 jQuery 对象的 length 属性获取复选框选中的个数"  id="b3"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b3"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                alert($(<span class="string">"input[type='checkbox']:checked"</span>).length);</span><br><span class="line">            &#125;);</span><br><span class="line">			<span class="comment">// &lt;input type="button" value=" 利用 jQuery 对象的 length 属性获取下拉框选中的个数"  id="b4"/&gt;</span></span><br><span class="line">            $(<span class="string">"#b4"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                alert($(<span class="string">"#job &gt; option:selected"</span>).length);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">	</span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ol>
</li>
</ol>
<h2 id="5-DOM操作"><a href="#5-DOM操作" class="headerlink" title="5.DOM操作"></a><strong>5.DOM操作</strong></h2><ol>
<li>内容操作<ol>
<li>html(): 获取/设置元素的标签体内容   &lt; a&gt;&lt; font&gt;内容&lt; /font&gt;&lt; /a&gt;  –&gt; &lt; font&gt;内容&lt; /font&gt;</li>
<li>text(): 获取/设置元素的标签体纯文本内容   &lt; a&gt;&lt; font&gt;内容&lt; /font&gt;&lt; /a&gt; –&gt; 内容</li>
<li>val()： 获取/设置元素的value属性值</li>
</ol>
</li>
<li>属性操作<ol>
<li>通用属性操作<ol>
<li>attr(): 获取/设置元素的属性</li>
<li>removeAttr():删除属性</li>
<li>prop():获取/设置元素的属性</li>
<li>removeProp():删除属性</li>
</ol>
<ul>
<li>attr和prop区别？<ol>
<li>如果操作的是元素的固有属性，则建议使用prop</li>
<li>如果操作的是元素自定义的属性，则建议使用attr</li>
</ol>
</li>
</ul>
</li>
<li>对class属性操作<ol>
<li>addClass():添加class属性值</li>
<li>removeClass():删除class属性值</li>
<li>toggleClass():切换class属性<ul>
<li>toggleClass(“one”): <ul>
<li>判断如果元素对象上存在class=”one”，则将属性值one删除掉。  如果元素对象上不存在class=”one”，则添加</li>
</ul>
</li>
</ul>
</li>
<li>css():</li>
</ol>
</li>
</ol>
</li>
<li>CRUD操作:<ol>
<li>append():父元素将子元素追加到末尾<ul>
<li>对象1.append(对象2): 将对象2添加到对象1元素内部，并且在末尾</li>
</ul>
</li>
<li>prepend():父元素将子元素追加到开头<ul>
<li>对象1.prepend(对象2):将对象2添加到对象1元素内部，并且在开头</li>
</ul>
</li>
<li>appendTo():<ul>
<li>对象1.appendTo(对象2):将对象1添加到对象2内部，并且在末尾</li>
</ul>
</li>
<li>prependTo()：<ul>
<li>对象1.prependTo(对象2):将对象1添加到对象2内部，并且在开头</li>
</ul>
</li>
<li>after():添加元素到元素后边<ul>
<li>对象1.after(对象2)： 将对象2添加到对象1后边。对象1和对象2是兄弟关系</li>
</ul>
</li>
<li>before():添加元素到元素前边<ul>
<li>对象1.before(对象2)： 将对象2添加到对象1前边。对象1和对象2是兄弟关系</li>
</ul>
</li>
<li>insertAfter()<ul>
<li>对象1.insertAfter(对象2)：将对象1添加到对象2后边。对象1和对象2是兄弟关系</li>
</ul>
</li>
<li>insertBefore()<ul>
<li>对象1.insertBefore(对象2)： 将对象1添加到对象2前边。对象1和对象2是兄弟关系</li>
</ul>
</li>
<li>remove():移除元素<ul>
<li>对象.remove():将对象删除掉</li>
</ul>
</li>
<li>empty():清空元素的所有后代元素。<ul>
<li>对象.empty():将对象的后代元素全部清空，但是保留当前对象以及其属性节点</li>
</ul>
</li>
<li>clone();克隆该元素，常与上述1 - 8 结合使用。</li>
</ol>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tukuai.github.io/2020/03/28/Web/JQuery%E5%9F%BA%E7%A1%80/" data-id="ckb22iuew005ozwu8e8tbfq04" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web/" rel="tag">Web</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JVM-Java虚拟机/内存结构" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/27/JVM-Java%E8%99%9A%E6%8B%9F%E6%9C%BA/%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/" class="article-date">
  <time datetime="2020-03-27T14:08:48.000Z" itemprop="datePublished">2020-03-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JVM/">JVM</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/27/JVM-Java%E8%99%9A%E6%8B%9F%E6%9C%BA/%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/">内存结构</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/images/161.png" alt=""></p>
<h2 id="1-程序计数器"><a href="#1-程序计数器" class="headerlink" title="1.程序计数器"></a><strong>1.程序计数器</strong></h2><p><strong>定义</strong><br>Program Counter Register 程序计数器（寄存器）<br><strong>作用</strong><br>是记住下一条jvm指令的执行地址<br><img src="/images/162.png" alt=""><br><strong>特点</strong></p>
<ul>
<li>是线程私有的,每个线程都有自己的程序计数器</li>
<li>不会存在内存溢出的区。</li>
</ul>
<h2 id="2-虚拟机栈"><a href="#2-虚拟机栈" class="headerlink" title="2.虚拟机栈"></a><strong>2.虚拟机栈</strong></h2><p><strong>定义</strong><br>Java Virtual Machine Stacks （Java 虚拟机栈）</p>
<ul>
<li>每个线程运行时所需要的内存，称为虚拟机栈</li>
<li>每个栈由多个栈帧（Frame）组成，对应着每次方法调用时所占用的内存</li>
<li>每个线程只能有一个活动栈帧，对应着当前正在执行的那个方法</li>
<li>方法进行依次根据调用情况压栈弹栈，方法内的局部变量在栈内存当中存储。如果通过new创建了对象，在堆内存中的对象的内存地址会被引用在在栈内存中。引用是保存了内存地址的变量。</li>
</ul>
<p><strong>问题辨析</strong></p>
<ol>
<li>垃圾回收是否涉及栈内存？<br>不会，垃圾回收管理的是堆内存中的内存回收</li>
<li>栈内存分配越大越好吗？<br>不是，栈内存越大反而会让线程数越少。因为每个线程都需要一个独立的栈。</li>
<li>方法内的局部变量是否线程安全？<br>如果方法内局部变量没有逃离方法的作用访问，它是线程安全的<br>如果是局部变量引用了对象，并逃离方法的作用范围，需要考虑线程安全</li>
</ol>
<p><strong>如</strong>下面代码中m1是线程安全的，但m2和m3都不是线程安全的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 局部变量的线程安全问题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo1_17</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();                                                                         </span><br><span class="line">        sb.append(<span class="number">4</span>);</span><br><span class="line">        sb.append(<span class="number">5</span>);</span><br><span class="line">        sb.append(<span class="number">6</span>);</span><br><span class="line">        <span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line">            m2(sb);</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">m1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        sb.append(<span class="number">1</span>);</span><br><span class="line">        sb.append(<span class="number">2</span>);</span><br><span class="line">        sb.append(<span class="number">3</span>);</span><br><span class="line">        System.out.println(sb.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">m2</span><span class="params">(StringBuilder sb)</span> </span>&#123;</span><br><span class="line">        sb.append(<span class="number">1</span>);</span><br><span class="line">        sb.append(<span class="number">2</span>);</span><br><span class="line">        sb.append(<span class="number">3</span>);</span><br><span class="line">        System.out.println(sb.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> StringBuilder <span class="title">m3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        sb.append(<span class="number">1</span>);</span><br><span class="line">        sb.append(<span class="number">2</span>);</span><br><span class="line">        sb.append(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">return</span> sb;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>栈内存溢出</strong></p>
<ul>
<li>栈帧过多导致栈内存溢出,StackOverflowError<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 演示栈内存溢出 java.lang.StackOverflowError</span></span><br><span class="line"><span class="comment"> * -Xss256k</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo1_2</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> count;                                                                                                   </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            method1();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.out.println(count);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        count++;</span><br><span class="line">        method1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>调用第三方库也可能导致占内存溢出。</li>
<li><em>如*</em>：下方代码，json数据将Dept类转化，但emp和Dept中数据相互引用导致占内存溢出。  需要加上@JsonIgnore。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * json 数据转换</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo1_19</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JsonProcessingException </span>&#123;                                                         </span><br><span class="line">        Dept d = <span class="keyword">new</span> Dept();</span><br><span class="line">        d.setName(<span class="string">"Market"</span>);</span><br><span class="line"></span><br><span class="line">        Emp e1 = <span class="keyword">new</span> Emp();</span><br><span class="line">        e1.setName(<span class="string">"zhang"</span>);</span><br><span class="line">        e1.setDept(d);</span><br><span class="line"></span><br><span class="line">        Emp e2 = <span class="keyword">new</span> Emp();</span><br><span class="line">        e2.setName(<span class="string">"li"</span>);</span><br><span class="line">        e2.setDept(d);</span><br><span class="line"></span><br><span class="line">        d.setEmps(Arrays.asList(e1, e2));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// &#123; name: 'Market', emps: [&#123; name:'zhang', dept:&#123; name:'', emps: [ &#123;&#125;]&#125; &#125;,] &#125;</span></span><br><span class="line">        ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        System.out.println(mapper.writeValueAsString(d));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Emp</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@JsonIgnore</span></span><br><span class="line">    <span class="keyword">private</span> Dept dept;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dept <span class="title">getDept</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dept;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDept</span><span class="params">(Dept dept)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.dept = dept;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dept</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Emp&gt; emps;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Emp&gt; <span class="title">getEmps</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> emps;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmps</span><span class="params">(List&lt;Emp&gt; emps)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.emps = emps;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>栈帧过大导致栈内存溢出</li>
</ul>
<p><strong>线程运行诊断</strong><br>案例1： cpu 占用过多<br>linux定位<br>用top定位哪个进程对cpu的占用过高<br>ps H -eo pid,tid,%cpu | grep 进程id （用ps命令进一步定位是哪个线程引起的cpu占用过高）<br>jstack 进程id<br>可以根据线程id(16进制的nid) 找到有问题的线程，进一步定位到问题代码的源码行号</p>
<p>案例2：程序运行很长时间没有结果</p>
<h2 id="3-本地方法栈"><a href="#3-本地方法栈" class="headerlink" title="3.本地方法栈"></a><strong>3.本地方法栈</strong></h2><p>本地方法：java利用调用c或者c++写的实现，以实现对底层操作系统的操作。<br>本地方法调用时所占用的内存空间为本地方法栈</p>
<h2 id="4-堆"><a href="#4-堆" class="headerlink" title="4.堆"></a><strong>4.堆</strong></h2><p><strong>定义</strong><br>Heap 堆<br>创建对象时通过new在堆内存当中开辟了一块新的空间，保存的是实例变量。与栈内存中的内存地址相对应。<br><strong>特点</strong></p>
<ul>
<li>它是线程共享的，堆中对象都需要考虑线程安全的问题</li>
<li>有垃圾回收机制<br><img src="/images/202.png" alt=""></li>
</ul>
<p><strong>堆内存溢出</strong><br>java.lang.OutOfMemoryError: Java heap space</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 演示堆内存溢出 java.lang.OutOfMemoryError: Java heap space</span></span><br><span class="line"><span class="comment"> * -Xmx8m</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo1_5</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();                                                                              </span><br><span class="line">            String a = <span class="string">"hello"</span>; </span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                list.add(a); <span class="comment">// hello, hellohello, hellohellohellohello ...</span></span><br><span class="line">                a = a + a;  <span class="comment">// hellohellohellohello</span></span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.out.println(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>堆内存诊断</strong>：在idea，terminal窗口输入指令</p>
<ol>
<li>jps 工具,指令：jps<br>查看当前系统中有哪些 java 进程</li>
<li>jmap 工具<br>查看堆内存占用情况,指令：jmap - heap 进程id</li>
<li>jconsole 工具,指令：jconsole<br>图形界面的，多功能的监测工具，可以连续监测<br>案例<br>垃圾回收后，内存占用仍然很高</li>
<li>jvisualvm工具<br>堆Dump，截取某时刻堆的内存信息，可以查看哪些内存占用过大</li>
</ol>
<h2 id="5-方法区"><a href="#5-方法区" class="headerlink" title="5.方法区"></a><strong>5.方法区</strong></h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a><strong>定义</strong></h3><p>The Java Virtual Machine has a method area that is shared among all Java Virtual Machine threads. The method area is analogous to the storage area for compiled code of a conventional language or analogous to the “text” segment in an operating system process. It stores per-class structures such as the run-time constant pool, field and method data, and the code for methods and constructors, including the special methods (§2.9) used in class and instance initialization and interface initialization.<br><strong>Java虚拟机中有一个被所有jvm线程共享的方法区。方法区有点类似于传统编程语言中的编译代码块或者操作系统层面的代码段。它存储着每个类的构造信息，譬如运行时的常量池，字段，方法数据，以及方法和构造方法的代码，包括一些在类和实例初始化和接口初始化时候使用的特殊方法。</strong></p>
<p>The method area is created on virtual machine start-up. Although the method area is logically part of the heap, simple implementations may choose not to either garbage collect or compact it. This specification does not mandate the location of the method area or the policies used to manage compiled code. The method area may be of a fixed size or may be expanded as required by the computation and may be contracted if a larger method area becomes unnecessary. The memory for the method area does not need to be contiguous.<br><strong>方法区在jvm启动时候被创建。虽然方法区在逻辑层面上是堆的一部分，但是就简单实现来说既不会被回收也不会被压缩。这个规范并不强制指定方法区存放的位置也不会对编译过的代码有管理策略的限制。方法区可能有一个固定的大小或者也可以通过计算大小去扩展也可以在不需要的时候被压缩。方法区的内存也不需要是连续的。</strong></p>
<p>A Java Virtual Machine implementation may provide the programmer or the user control over the initial size of the method area, as well as, in the case of a varying-size method area, control over the maximum and minimum method area size.<br><strong>Jvm虚拟机实现可以提供给编程人员或者用户初始化方法区的大小，同时在方法区可变大小的情况下，控制这个方法区的最大值和最小值。</strong><br>The following exceptional condition is associated with the method area:<br><strong>下面这种异常情况是和方法区有关联的：</strong><br>If memory in the method area cannot be made available to satisfy an allocation request, the Java Virtual Machine throws an OutOfMemoryError.<br><strong>如果方法区满足不了构造所需要的内存，jvm就会抛出OutOfMemoryError。</strong></p>
<h2 id="方法区位置"><a href="#方法区位置" class="headerlink" title="方法区位置"></a><strong>方法区位置</strong></h2><p>元空间是方法区的在 HotSpot JVM 中的实现<br>方法区主要用于存储类信息、常量池、方法数据、方法代码、符号引用等。元空间的本质和永久代类似，都是对 JVM 规范中方法区的实现。不过元空间与永久代之间最大的区别在于：元空间并不在虚拟机中，而是使用本地内存。，理论上取决于32位/64位系统内存大小，可以通过 -XX:MetaspaceSize 和 -XX:MaxMetaspaceSize 配置内存大小。</p>
<h2 id="随JDK版本变迁的方法区"><a href="#随JDK版本变迁的方法区" class="headerlink" title="随JDK版本变迁的方法区"></a><strong>随JDK版本变迁的方法区</strong></h2><p><strong>JDK6</strong><br>Klass 元数据信息<br>每个类的运行时常量池（字段、方法、类、接口等符号引用）、编译后的代码<br>静态字段（无论是否有final）在 instanceKlass 末尾（位于 PermGen 内）<br>oop（Ordinary Object Pointer（普通对象指针）） 其实就是 Class 对象实例<br>全局字符串常量池 StringTable，本质上就是个 Hashtable<br>符号引用（类型指针是 SymbolKlass）</p>
<p><strong>JDK7</strong><br>Klass 元数据信息<br>每个类的运行时常量池（字段、方法、类、接口等符号引用）、编译后的代码<br>静态字段从 instanceKlass 末尾移动到了 java.lang.Class 对象（oop）的末尾（位于 Java Heap 内）<br>oop 与全局字符串常量池移到 Java Heap 上<br>符号引用被移动到 Native Heap 中</p>
<p><strong>JDK8</strong><br>移除永久代<br>Klass 元数据信息<br>每个类的运行时常量池、编译后的代码移到了另一块与堆不相连的本地内存 – 元空间（Metaspace）</p>
<h3 id="组成"><a href="#组成" class="headerlink" title="组成"></a><strong>组成</strong></h3><p><img src="/images/163.png" alt=""></p>
<h3 id="方法区内存溢出"><a href="#方法区内存溢出" class="headerlink" title="方法区内存溢出"></a><strong>方法区内存溢出</strong></h3><p>1.8 以前会导致永久代内存溢出</p>
<ul>
<li>演示永久代内存溢出 java.lang.OutOfMemoryError: PermGen space * -XX:MaxPermSize=8m</li>
</ul>
<p>1.8 之后会导致元空间内存溢出  java.lang.OutOfMemoryError: Metaspace</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 演示元空间内存溢出 java.lang.OutOfMemoryError: Metaspace</span></span><br><span class="line"><span class="comment"> * -XX:MaxMetaspaceSize=8m</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo1_8</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span> </span>&#123; <span class="comment">// 可以用来加载类的二进制字节码</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Demo1_8 test = <span class="keyword">new</span> Demo1_8();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++, j++) &#123;</span><br><span class="line">                <span class="comment">// ClassWriter 作用是生成类的二进制字节码</span></span><br><span class="line">                ClassWriter cw = <span class="keyword">new</span> ClassWriter(<span class="number">0</span>);</span><br><span class="line">                <span class="comment">// 版本号， public， 类名, 包名, 父类， 接口      </span></span><br><span class="line">                cw.visit(Opcodes.V1_8, Opcodes.ACC_PUBLIC, <span class="string">"Class"</span> + i, <span class="keyword">null</span>, <span class="string">"java/lang/Object"</span>, <span class="keyword">null</span>);                                    </span><br><span class="line">                <span class="comment">// 返回 byte[]</span></span><br><span class="line">                <span class="keyword">byte</span>[] code = cw.toByteArray();</span><br><span class="line">                <span class="comment">// 执行了类的加载</span></span><br><span class="line">                test.defineClass(<span class="string">"Class"</span> + i, code, <span class="number">0</span>, code.length); <span class="comment">// Class 对象</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            System.out.println(j);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>场景</strong></p>
<ul>
<li>spring和mybatis:<br>cglib,动态生成类字节码，动态的类加载，代理技术中广泛运用的，会大量生成运行时的类。</li>
</ul>
<h3 id="运行时常量池"><a href="#运行时常量池" class="headerlink" title="运行时常量池"></a><strong>运行时常量池</strong></h3><p>二进制字节码:(类基本信息，常量池，类自定义方法，包含了虚拟机指令)<br>原类内容</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> t5;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 二进制字节码（类基本信息，常量池，类方法定义，包含了虚拟机指令）                                 </span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"hello world"</span>);                                                                                              </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在terminal控制台输入指令：javap-v HelloWorld.class  可以对二进制字节码进行反编译。class文件在out里</p>
<hr>
<pre><code>            D:\IdeaProjects\basic-code\jvm\out\production\jvm\t5&gt;javap -v HelloWorld.class
类基本信息
            Classfile /D:/IdeaProjects/basic-code/jvm/out/production/jvm/t5/HelloWorld.class
            Last modified 2020-3-29; size 539 bytes
            MD5 checksum 7dede3a2ea79b7095ea4e895d2a766b1
            Compiled from &quot;HelloWorld.java&quot;
            public class t5.HelloWorld
            minor version: 0
            major version: 52
            flags: ACC_PUBLIC, ACC_SUPER
常量池
            Constant pool:
               #1 = Methodref          #6.#20         // java/lang/Object.&quot;&lt;init&gt;&quot;:()V
               #2 = Fieldref           #21.#22        // java/lang/System.out:Ljava/io/PrintStream;
               #3 = String             #23            // hello world
               #4 = Methodref          #24.#25        // java/io/PrintStream.println:(Ljava/lang/String;)V
               #5 = Class              #26            // t5/HelloWorld
               #6 = Class              #27            // java/lang/Object
               #7 = Utf8               &lt;init&gt;
               #8 = Utf8               ()V
               #9 = Utf8               Code
              #10 = Utf8               LineNumberTable
              #11 = Utf8               LocalVariableTable
              #12 = Utf8               this
              #13 = Utf8               Lt5/HelloWorld;
              #14 = Utf8               main
              #15 = Utf8               ([Ljava/lang/String;)V
              #16 = Utf8               args
              #17 = Utf8               [Ljava/lang/String;
              #18 = Utf8               SourceFile
              #19 = Utf8               HelloWorld.java
              #20 = NameAndType        #7:#8          // &quot;&lt;init&gt;&quot;:()V
              #21 = Class              #28            // java/lang/System
              #22 = NameAndType        #29:#30        // out:Ljava/io/PrintStream;
              #23 = Utf8               hello world
              #24 = Class              #31            // java/io/PrintStream
              #25 = NameAndType        #32:#33        // println:(Ljava/lang/String;)V
              #26 = Utf8               t5/HelloWorld
              #27 = Utf8               java/lang/Object
              #28 = Utf8               java/lang/System
              #29 = Utf8               out
              #30 = Utf8               Ljava/io/PrintStream;
              #31 = Utf8               java/io/PrintStream
              #32 = Utf8               println
              #33 = Utf8               (Ljava/lang/String;)V
类的方法定义   
              {
                public t5.HelloWorld();  
                descriptor: ()V
                flags: ACC_PUBLIC
                Code:
                  stack=1, locals=1, args_size=1
                     0: aload_0
                     1: invokespecial #1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V
                     4: return
                  LineNumberTable:
                    line 4: 0
                  LocalVariableTable:
                    Start  Length  Slot  Name   Signature
                        0       5     0  this   Lt5/HelloWorld;
              public static void main(java.lang.String[]);
                descriptor: ([Ljava/lang/String;)V
                flags: ACC_PUBLIC, ACC_STATIC
    虚拟机指令
                Code:
                  stack=2, locals=1, args_size=1
    获取静态变量      0: getstatic     #2                  // Field java/lang/System.out:Ljava/io/PrintStream;
    加载参数          3: ldc           #3                  // String hello world
    虚方法调用        5: invokevirtual #4                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V
    执行结束          8: return
                  LineNumberTable:
                    line 6: 0
                    line 7: 8
                  LocalVariableTable:
                    Start  Length  Slot  Name   Signature
                        0       9     0  args   [Ljava/lang/String;
            }
            SourceFile: &quot;HelloWorld.java&quot;</code></pre><hr>
<p><strong>常量池：</strong>就是一张表，虚拟机指令根据这张常量表找到要执行的类名、方法名、参数类型、字面量等信息<br>运行时常量池：常量池是 * .class 文件中的，当该类被加载，它的常量池信息就会放入运行时常量池，并把里面的符号地址变为真实地址<br><strong>StringTable</strong>,<br>StringTable[]底层是一个不能扩容的hash表</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// StringTable [ "a", "b" ,"ab" ]  hashtable 结构，不能扩容</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo1_22</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 常量池中的信息，都会被加载到运行时常量池中， 这时 a b ab 都是常量池中的符号，还没有变为 java 字符串对象</span></span><br><span class="line">    <span class="comment">// ldc #2 会把 a 符号变为 "a" 字符串对象(先在串池里面找，里面没有就放入串池，如果串池里面已经有了就会使用串池里面的对象)</span></span><br><span class="line">    <span class="comment">// ldc #3 会把 b 符号变为 "b" 字符串对象</span></span><br><span class="line">    <span class="comment">// ldc #4 会把 ab 符号变为 "ab" 字符串对象</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String s1 = <span class="string">"a"</span>; <span class="comment">// 懒惰的</span></span><br><span class="line">        String s2 = <span class="string">"b"</span>;</span><br><span class="line">        String s3 = <span class="string">"ab"</span>;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        0: ldc           #2                  // String a</span></span><br><span class="line"><span class="comment">         2: astore_1</span></span><br><span class="line"><span class="comment">         3: ldc           #3                  // String b</span></span><br><span class="line"><span class="comment">         5: astore_2</span></span><br><span class="line"><span class="comment">         6: ldc           #4                  // String ab</span></span><br><span class="line"><span class="comment">         8: astore_3</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        String s4 = s1 + s2;     </span><br><span class="line">        <span class="comment">// new StringBuilder().append("a").append("b").toString()  new String("ab")</span></span><br><span class="line">        <span class="comment">/* </span></span><br><span class="line"><span class="comment">        9: new           #5                  // class java/lang/StringBuilder</span></span><br><span class="line"><span class="comment">        12: dup</span></span><br><span class="line"><span class="comment">        13: invokespecial #6                  // Method java/lang/StringBuilder."&lt;init&gt;":()V</span></span><br><span class="line"><span class="comment">        16: aload_1                           // 将s1加载</span></span><br><span class="line"><span class="comment">        17: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span></span><br><span class="line"><span class="comment">        20: aload_2</span></span><br><span class="line"><span class="comment">        21: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span></span><br><span class="line"><span class="comment">        24: invokevirtual #8                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;</span></span><br><span class="line"><span class="comment">        27: astore        4</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        System.out.println(s3 == s4);<span class="comment">//false</span></span><br><span class="line">        String s5 = <span class="string">"a"</span> + <span class="string">"b"</span>;  <span class="comment">// javac 在编译期间的优化，结果已经在编译期确定为ab</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         29: ldc           #4                  // String ab</span></span><br><span class="line"><span class="comment">        31: astore        5</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        System.out.println(s3 == s5);<span class="comment">//true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>反编译结果：</p>
<pre><code>Code:
  stack=3, locals=6, args_size=1
     0: ldc           #2                  // String a
     2: astore_1
     3: ldc           #3                  // String b
     5: astore_2
     6: ldc           #4                  // String ab
     8: astore_3
     9: new           #5                  // class java/lang/StringBuilder
    12: dup
    13: invokespecial #6                  // Method java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:()V
    16: aload_1                           // 将s1加载
    17: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    20: aload_2
    21: invokevirtual #7                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
    24: invokevirtual #8                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;
    27: astore        4
    29: ldc           #4                  // String ab
    31: astore        5
    33: getstatic     #9                  // Field java/lang/System.out:Ljava/io/PrintStream;
    36: aload_3
    37: aload         5
    39: if_acmpne     46
    42: iconst_1
    43: goto          47
    46: iconst_0
    47: invokevirtual #10                 // Method java/io/PrintStream.println:(Z)V
    50: return
  LineNumberTable:
    line 11: 0
    line 12: 3
    line 13: 6
    line 14: 9
    line 15: 29
    line 17: 33
    line 21: 50
  LocalVariableTable:
    Start  Length  Slot  Name   Signature
        0      51     0  args   [Ljava/lang/String;
        3      48     1    s1   Ljava/lang/String;
        6      45     2    s2   Ljava/lang/String;
        9      42     3    s3   Ljava/lang/String;
       29      22     4    s4   Ljava/lang/String;
       33      18     5    s5   Ljava/lang/String;
      }</code></pre><p><strong>原因</strong>：s1和s2都是变量，在编译期间不能得知s1+s2的最终结果，但”a”+”b”是常量在编译期间可以得出其结果，所以编译优化直接使其指向串池中已有的常量。<br><strong>结论</strong>：1.8：动态拼接的字符串不会放入串池中，而是在堆中，字符串调用inner方法，会将该字符串放入串池，如果有则不会放，而是返回串池中值相同的字符串对象。<br>1.6：动态拼接的字符串不会放入串池中，而是在堆中，字符串调用inner方法，会将该字符串<strong>复制后</strong>放入串池，如果有则不会放，而是返回串池中值相同的字符串对象。</p>
<p>常量池中的字符串仅是符号，第一次调到时才变为对象<br>利用串池的机制，来避免重复创建字符串对象<br>字符串变量拼接的原理是 StringBuilder （1.8）<br>字符串常量拼接的原理是编译期优化<br>可以使用 intern 方法，主动将串池中还没有的字符串对象放入串池<br>1.8 将这个字符串对象尝试放入串池，如果有则并不会放入，如果没有则放入串池， 会把串池中的对象返回<br>1.6 将这个字符串对象尝试放入串池，如果有则并不会放入，如果没有会把此对象复制一份，放入串池， 会把串池中的对象返回<br><strong>面试题</strong><br><strong>String s1 = “a”;<br>String s2 = “b”;<br>String s3 = “a” + “b”;<br>String s4 = s1 + s2;<br>String s5 = “ab”;<br>String s6 = s4.intern();<br>// 问<br>System.out.println(s3 == s4);<br>System.out.println(s3 == s5);<br>System.out.println(s3 == s6);<br>String x2 = new String(“c”) + new String(“d”);<br>String x1 = “cd”;<br>x2.intern();<br>// 问，如果调换了【最后两行代码】的位置呢，如果是jdk1.6呢<br>System.out.println(x1 == x2)</strong><br><strong><em>答案</em></strong>：false，true，true，false<br>如果调换位置：false，true，true，true<br>1.6：false，true，true，false</p>
<p><strong>StringTable 位置</strong><br><strong>1.6：</strong>在常量池中，常量池(包含于方法区中)在永久代中；<br><strong>1.7及以后：</strong>在堆中，方法区在元空间<br><strong>原因</strong>：永久代的内存回收效率很低，永久在需要等到老年代空间不足才能回收，触发事件太晚，但StringTable经常使用，很容易导致永久代内存不足。<br><img src="/images/164.png" alt=""></p>
<p><strong>StringTable 垃圾回收</strong><br>若StringTable中字符串数量较多时会调用垃圾回收。<br><strong>StringTable 性能调优</strong><br>主要是调整hashtable的桶的个数，桶较多时散列查询和存放速度会比较快，因为每个链表个数会较短，而链表的删和查是与链表长度直接关联的。<br>调整 -XX:StringTableSize=桶个数<br><strong>考虑将字符串对象是否入池</strong><br>若字符串重复过多，入池则会大大提高内存效率。</p>
<h2 id="直接内存"><a href="#直接内存" class="headerlink" title="直接内存"></a><strong>直接内存</strong></h2><p><strong>定义</strong></p>
<ul>
<li>Direct Memory</li>
<li>常见于 NIO 操作时，用于数据缓冲区,ByteBuffer.allocateDirect()使用的就是直接内存。其底层是调用Unsafe对象的allocateMemory()方法.</li>
<li>分配回收成本较高，但读写性能高</li>
<li>不受 JVM 内存回收管理，所以不是通过GC垃圾回收的，而是通过Unsafe类中的freeMemory完成的。</li>
</ul>
<p><strong>不使用直接内存的情况</strong><br>由于系统内存java代码不能直接访问，所以需要再次复制到java堆内存中，存在多余的操作。<br><img src="/images/169.png" alt=""><br><strong>使用直接内存的情况</strong><br>java代码可以直接操作Direct Memory，所以省去了复制到java堆的过程。<br><img src="/images/170.png" alt=""></p>
<p><strong>分配和回收原理</strong></p>
<ul>
<li>使用了 Unsafe 对象完成直接内存的分配回收，并且回收需要主动调用 freeMemory 方法。</li>
<li>ByteBuffer 的实现类内部，使用了 Cleaner （虚引用）来监测 ByteBuffer 对象，一旦ByteBuffer 对象被垃圾回收，那么就会由 ReferenceHandler 线程通过Cleaner 的clean方法简介调用 freeMemory 来释放直接内存。</li>
<li>一般使ByteBuffer为null时，还需要调用Unsafe类中的freeMemory来手动回收掉这部分没对象指向的内存。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tukuai.github.io/2020/03/27/JVM-Java%E8%99%9A%E6%8B%9F%E6%9C%BA/%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/" data-id="ckb22iudp001qzwu80mdvgx4r" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JVM/" rel="tag">JVM</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JVM-Java虚拟机/JVM入门" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/27/JVM-Java%E8%99%9A%E6%8B%9F%E6%9C%BA/JVM%E5%85%A5%E9%97%A8/" class="article-date">
  <time datetime="2020-03-27T13:51:35.000Z" itemprop="datePublished">2020-03-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/JVM/">JVM</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/27/JVM-Java%E8%99%9A%E6%8B%9F%E6%9C%BA/JVM%E5%85%A5%E9%97%A8/">JVM入门</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="什么是JVM"><a href="#什么是JVM" class="headerlink" title="什么是JVM"></a><strong>什么是JVM</strong></h2><p><strong>定义：</strong><br>Java Virtual Machine-java程序的运行环境(java二进制字节码的运行环境)</p>
<p><strong>好处：</strong></p>
<ul>
<li>一次编写，到处运行</li>
<li>自动内存管理，垃圾回收功能</li>
<li>数组下标越界检查，避免覆盖其他代码的内存</li>
<li>多态</li>
</ul>
<p><strong>比较</strong><br><img src="/images/160.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tukuai.github.io/2020/03/27/JVM-Java%E8%99%9A%E6%8B%9F%E6%9C%BA/JVM%E5%85%A5%E9%97%A8/" data-id="ckb22iudo001jzwu83dxm2uks" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JVM/" rel="tag">JVM</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Web/Filter&amp;Listener" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/27/Web/Filter&Listener/" class="article-date">
  <time datetime="2020-03-27T07:00:24.000Z" itemprop="datePublished">2020-03-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/27/Web/Filter&Listener/">Filter&amp;Listener</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Filter：过滤器"><a href="#Filter：过滤器" class="headerlink" title="Filter：过滤器"></a>Filter：过滤器</h1><h2 id="一-概念："><a href="#一-概念：" class="headerlink" title="一.概念："></a><strong>一.概念：</strong></h2><ul>
<li>生活中的过滤器：净水器,空气净化器，土匪、</li>
<li>web中的过滤器：当访问服务器的资源时，过滤器可以将请求拦截下来，完成一些特殊的功能。</li>
<li>过滤器的作用：<ul>
<li>一般用于完成通用的操作。如：登录验证、统一编码处理、敏感字符过滤…</li>
</ul>
</li>
</ul>
<h2 id="二-快速入门："><a href="#二-快速入门：" class="headerlink" title="二.快速入门："></a><strong>二.快速入门：</strong></h2><ol>
<li>步骤：<ol>
<li>定义一个类，实现接口Filter</li>
<li>复写方法</li>
<li>配置拦截路径<ol>
<li>web.xml</li>
<li>注解</li>
</ol>
</li>
</ol>
</li>
<li>代码：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter</span>(<span class="string">"/* "</span>)<span class="comment">//访问所有资源之前，都会执行该过滤器</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FilterDemo1</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;	</span><br><span class="line">    &#125;	</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"filterDemo1被执行了...."</span>);	</span><br><span class="line">        <span class="comment">//放行</span></span><br><span class="line">        filterChain.doFilter(servletRequest,servletResponse);	</span><br><span class="line">    &#125;	</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;	</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="三-过滤器细节："><a href="#三-过滤器细节：" class="headerlink" title="三.过滤器细节："></a><strong>三.过滤器细节：</strong></h2><h3 id="1-web-xml配置"><a href="#1-web-xml配置" class="headerlink" title="1.web.xml配置"></a><strong>1.web.xml配置</strong></h3><filter>
    <filter-name>demo1</filter-name>
    <filter-class>cn.itcast.web.filter.FilterDemo1</filter-class>
</filter>
<filter-mapping>
    <filter-name>demo1</filter-name>
    <!-- 拦截路径 -->
    <url-pattern>/*</url-pattern>
</filter-mapping>

<h3 id="2-过滤器执行流程"><a href="#2-过滤器执行流程" class="headerlink" title="2.过滤器执行流程"></a><strong>2.过滤器执行流程</strong></h3><ol>
<li>执行过滤器</li>
<li>执行放行后的资源</li>
<li>回来执行过滤器放行代码下边的代码<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@WebFilter("/*")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FilterDemo2</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse resp, FilterChain chain)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//对request对象请求消息增强</span></span><br><span class="line">        System.out.println(<span class="string">"filterDemo2执行了...."</span>);</span><br><span class="line">        <span class="comment">//放行</span></span><br><span class="line">        chain.doFilter(req, resp);</span><br><span class="line">        <span class="comment">//对response对象的响应消息增强</span></span><br><span class="line">        System.out.println(<span class="string">"filterDemo2回来了..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;  &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="3-过滤器生命周期方法"><a href="#3-过滤器生命周期方法" class="headerlink" title="3.过滤器生命周期方法"></a><strong>3.过滤器生命周期方法</strong></h3><ol>
<li>init:在服务器启动后，会创建Filter对象，然后调用init方法。只执行一次。用于加载资源</li>
<li>doFilter:每一次请求被拦截资源时，会执行。执行多次</li>
<li>destroy:在服务器关闭后，Filter对象被销毁。如果服务器是正常关闭，则会执行destroy方法。只执行一次。用于释放资源</li>
</ol>
<h3 id="4-过滤器配置详解"><a href="#4-过滤器配置详解" class="headerlink" title="4.过滤器配置详解"></a><strong>4.过滤器配置详解</strong></h3><ul>
<li>拦截路径配置：<ol>
<li>具体资源路径： /index.jsp   只有访问index.jsp资源时，过滤器才会被执行</li>
<li>拦截目录： /user/*    访问/user下的所有资源时，过滤器都会被执行</li>
<li>后缀名拦截： * .jsp        访问所有后缀名为jsp资源时，过滤器都会被执行,<strong>注意：</strong>后缀名拦截没有/</li>
<li>拦截所有资源：/*        访问所有资源时，过滤器都会被执行</li>
</ol>
</li>
<li>拦截方式配置：资源被访问的方式<ul>
<li>注解配置：<ul>
<li>设置dispatcherTypes属性，可以同时配置多个值，用{}包含。<ol>
<li>REQUEST：默认值。浏览器直接请求资源</li>
<li>FORWARD：转发访问资源</li>
<li>INCLUDE：包含访问资源</li>
<li>ERROR：错误跳转资源</li>
<li>ASYNC：异步访问资源</li>
</ol>
</li>
</ul>
</li>
<li>web.xml配置<ul>
<li>设置<dispatcher></dispatcher>标签即可</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="5-过滤器链-配置多个过滤器"><a href="#5-过滤器链-配置多个过滤器" class="headerlink" title="5.过滤器链(配置多个过滤器)"></a><strong>5.过滤器链(配置多个过滤器)</strong></h3><ul>
<li>执行顺序：如果有两个过滤器：过滤器1和过滤器2<ol>
<li>过滤器1</li>
<li>过滤器2</li>
<li>资源执行</li>
<li>过滤器2</li>
<li>过滤器1 </li>
</ol>
</li>
<li>过滤器先后顺序问题：<ol>
<li>注解配置：按照类名的字符串比较规则比较，值小的先执行<ul>
<li>如： AFilter 和 BFilter，AFilter就先执行了。</li>
</ul>
</li>
<li>web.xml配置： <filter-mapping>谁定义在上边，谁先执行</li>
</ol>
</li>
</ul>
<h2 id="4-案例："><a href="#4-案例：" class="headerlink" title="4. 案例："></a><strong>4. 案例：</strong></h2><ol>
<li>案例1_登录验证<ul>
<li>需求：<ol>
<li>访问day17_case案例的资源。验证其是否登录</li>
<li>如果登录了，则直接放行。</li>
<li>如果没有登录，则跳转到登录页面，提示”您尚未登录，请先登录”。</li>
</ol>
</li>
</ul>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter</span>(<span class="string">"/*"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse resp, FilterChain chain)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(req);</span><br><span class="line">        <span class="comment">//0.强制转换</span></span><br><span class="line">        HttpServletRequest request = (HttpServletRequest) req;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.获取资源请求路径</span></span><br><span class="line">        String uri = request.getRequestURI();</span><br><span class="line">        <span class="comment">//2.判断是否包含登录相关资源路径,要注意排除掉 css/js/图片/验证码等资源</span></span><br><span class="line">        <span class="keyword">if</span>(uri.contains(<span class="string">"/login.jsp"</span>) || uri.contains(<span class="string">"/loginServlet"</span>) || uri.contains(<span class="string">"/css/"</span>) || uri.contains(<span class="string">"/js/"</span>) || uri.contains(<span class="string">"/fonts/"</span>) || uri.contains(<span class="string">"/checkCodeServlet"</span>)  )&#123;</span><br><span class="line">            <span class="comment">//包含，用户就是想登录。放行</span></span><br><span class="line">            chain.doFilter(req, resp);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//不包含，需要验证用户是否登录</span></span><br><span class="line">            <span class="comment">//3.从获取session中获取user</span></span><br><span class="line">            Object user = request.getSession().getAttribute(<span class="string">"user"</span>);</span><br><span class="line">            <span class="keyword">if</span>(user != <span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="comment">//登录了。放行</span></span><br><span class="line">                chain.doFilter(req, resp);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//没有登录。跳转登录页面</span></span><br><span class="line"></span><br><span class="line">                request.setAttribute(<span class="string">"login_msg"</span>,<span class="string">"您尚未登录，请登录"</span>);</span><br><span class="line">                request.getRequestDispatcher(<span class="string">"/login.jsp"</span>).forward(request,resp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<ol start="2">
<li><p>案例2_敏感词汇过滤</p>
<ul>
<li><p>需求：</p>
<ol>
<li>对day17_case案例录入的数据进行敏感词汇过滤</li>
<li>敏感词汇参考《敏感词汇.txt》</li>
<li>如果是敏感词汇，替换为 *** </li>
</ol>
</li>
<li><p>分析：</p>
<ol>
<li>对request对象进行增强。增强获取参数相关方法</li>
<li>放行。传递代理对象</li>
</ol>
</li>
<li><p>增强对象的功能：</p>
<ul>
<li>设计模式：一些通用的解决固定问题的方式</li>
</ul>
<ol>
<li>装饰模式</li>
<li>代理模式<ul>
<li>概念：<ol>
<li>真实对象：被代理的对象</li>
<li>代理对象：</li>
<li>代理模式：代理对象代理真实对象，达到增强真实对象功能的目的<ul>
<li>实现方式：</li>
</ul>
<ol>
<li>静态代理：有一个类文件描述代理模式</li>
<li>动态代理：在内存中形成代理类<ul>
<li>实现步骤：<ol>
<li>代理对象和真实对象实现相同的接口</li>
<li>代理对象 = Proxy.newProxyInstance();</li>
<li>使用代理对象调用方法。</li>
<li>增强方法</li>
</ol>
</li>
<li>增强方式：<ol>
<li>增强参数列表</li>
<li>增强返回值类型</li>
<li>增强方法体执行逻辑    </li>
</ol>
</li>
</ul>
</li>
</ol>
</li>
</ol>
</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 敏感词汇过滤器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebFilter</span>(<span class="string">"/*"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SensitiveWordsFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse resp, FilterChain chain)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//1.创建代理对象，增强getParameter方法</span></span><br><span class="line">        ServletRequest proxy_req = (ServletRequest) Proxy.newProxyInstance(req.getClass().getClassLoader(), req.getClass().getInterfaces(), <span class="keyword">new</span> InvocationHandler() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">                <span class="comment">//增强getParameter方法</span></span><br><span class="line">                <span class="comment">//判断是否是getParameter方法</span></span><br><span class="line">                <span class="keyword">if</span>(method.getName().equals(<span class="string">"getParameter"</span>))&#123;</span><br><span class="line">                    <span class="comment">//增强返回值</span></span><br><span class="line">                    <span class="comment">//获取返回值</span></span><br><span class="line">                    String value = (String) method.invoke(req,args);</span><br><span class="line">                    <span class="keyword">if</span>(value != <span class="keyword">null</span>)&#123;</span><br><span class="line">                        <span class="keyword">for</span> (String str : list) &#123;</span><br><span class="line">                            <span class="keyword">if</span>(value.contains(str))&#123;</span><br><span class="line">                                value = value.replaceAll(str,<span class="string">"***"</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;                  </span><br><span class="line">                    <span class="keyword">return</span>  value;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//判断方法名是否是 getParameterMap</span></span><br><span class="line">                <span class="comment">//判断方法名是否是 getParameterValue</span></span><br><span class="line">               <span class="keyword">return</span> method.invoke(req,args);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//2.放行</span></span><br><span class="line">        chain.doFilter(proxy_req, resp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;String&gt;();<span class="comment">//敏感词汇集合</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//1.获取文件真实路径</span></span><br><span class="line">            ServletContext servletContext = config.getServletContext();</span><br><span class="line">            String realPath = servletContext.getRealPath(<span class="string">"/WEB-INF/classes/敏感词汇.txt"</span>);</span><br><span class="line">            <span class="comment">//2.读取文件</span></span><br><span class="line">            BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(realPath));</span><br><span class="line">            <span class="comment">//3.将文件的每一行数据添加到list中</span></span><br><span class="line">            String line = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">while</span>((line = br.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                list.add(line);</span><br><span class="line">            &#125;</span><br><span class="line">            br.close();</span><br><span class="line">            System.out.println(list);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Listener：监听器"><a href="#Listener：监听器" class="headerlink" title="Listener：监听器"></a><strong>Listener：监听器</strong></h1><ul>
<li>概念：web的三大组件之一。<ul>
<li>事件监听机制<ul>
<li>事件    ：一件事情</li>
<li>事件源 ：事件发生的地方</li>
<li>监听器 ：一个对象</li>
<li>注册监听：将事件、事件源、监听器绑定在一起。 当事件源上发生某个事件后，执行监听器代码</li>
</ul>
</li>
</ul>
</li>
<li>ServletContextListener:监听ServletContext对象的创建和销毁<ul>
<li>方法：<ul>
<li>void contextDestroyed(ServletContextEvent sce) ：ServletContext对象被销毁之前会调用该方法</li>
<li>void contextInitialized(ServletContextEvent sce) ：ServletContext对象创建后会调用该方法</li>
</ul>
</li>
<li>步骤：<ol>
<li>定义一个类，实现ServletContextListener接口</li>
<li>复写方法</li>
<li>配置<ol>
<li>web.xml<pre><code>&lt;listener&gt;
  &lt;listener-class&gt;cn.itcast.web.listener.ContextLoaderListener&lt;/listener-class&gt;
    &lt;/listener&gt;
* 指定初始化参数&lt;context-param&gt;</code></pre></li>
<li>注解：<ul>
<li>@WebListener</li>
</ul>
</li>
</ol>
</li>
</ol>
</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tukuai.github.io/2020/03/27/Web/Filter&Listener/" data-id="ckb22iueu005dzwu88ps7504n" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web/" rel="tag">Web</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-LeetCode/1-两数之和" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/26/LeetCode/1-%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/" class="article-date">
  <time datetime="2020-03-25T16:07:34.000Z" itemprop="datePublished">2020-03-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/LeetCode/">LeetCode</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/26/LeetCode/1-%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/">1-两数之和</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>题目：</strong>给定一个整数数组 nums 和一个目标值 target，请你在该数组中找出和为目标值的那 两个 整数，并返回他们的数组下标。<br>你可以假设每种输入只会对应一个答案。但是，你不能重复利用这个数组中同样的元素。</p>
<p><strong>思路：</strong>将前面遍历的数存入HashMap中，key为下表为i的数的补数，value为下标i，每次判断时只需要判断map中是否有与当前值对应的值。省去了一次循环的时间。<br><strong>解法：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] twoSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">       <span class="keyword">int</span>[] index=<span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</span><br><span class="line">       HashMap&lt;Integer,Integer&gt; h=<span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">       <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.length;i++)</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">if</span>(h.get(nums[i])!=<span class="keyword">null</span>)</span><br><span class="line">           &#123;</span><br><span class="line">               index[<span class="number">0</span>]=h.get(nums[i]);</span><br><span class="line">               index[<span class="number">1</span>]=i;</span><br><span class="line">               <span class="keyword">return</span> index;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">else</span></span><br><span class="line">           &#123;</span><br><span class="line">               h.put(target-nums[i],i);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://tukuai.github.io/2020/03/26/LeetCode/1-%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/" data-id="ckb22iue2002xzwu80ngl1c4c" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LeetCode/" rel="tag">LeetCode</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Web/Session" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/25/Web/Session/" class="article-date">
  <time datetime="2020-03-25T09:46:24.000Z" itemprop="datePublished">2020-03-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/25/Web/Session/">Session</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Session：有道翻译：会话"><a href="#Session：有道翻译：会话" class="headerlink" title="Session：有道翻译：会话"></a><strong>Session：有道翻译：会话</strong></h2><ol>
<li>概念：服务器端会话技术，在<strong>一次会话</strong>的多次请求间共享数据，将数据保存在服务器端的对象中。HttpSession</li>
<li>快速入门：<ol>
<li>获取HttpSession对象：<br> HttpSession session = request.getSession();</li>
<li>使用HttpSession对象：<br> Object getAttribute(String name)<br> void setAttribute(String name, Object value)<br> void removeAttribute(String name)  </li>
</ol>
</li>
<li>原理<br><img src="/images/156.png" alt=""><ul>
<li>Session的实现是依赖于Cookie的。</li>
</ul>
</li>
<li>细节：<ol>
<li>当客户端关闭后，服务器不关闭，两次获取session是否为同一个？<ul>
<li>默认情况下。不是。</li>
<li>如果需要相同，则可以创建Cookie,键为JSESSIONID，设置最大存活时间，让cookie持久化保存。<br>   Cookie c = new Cookie(“JSESSIONID”,session.getId());<br>   c.setMaxAge(60* 60);<br>   response.addCookie(c);</li>
</ul>
</li>
<li>客户端不关闭，服务器关闭后，两次获取的session是同一个吗？<ul>
<li>不是同一个，但是要确保数据不丢失。tomcat自动完成以下工作，地址值不一样，但是ID是一样的<ul>
<li>session的钝化：<ul>
<li>在服务器正常关闭之前，将session对象系列化到硬盘上</li>
</ul>
</li>
<li>session的活化：<ul>
<li>在服务器启动后，将session文件转化为内存中的session对象即可。            </li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>session什么时候被销毁？<ol>
<li>服务器关闭</li>
<li>session对象调用invalidate() 。</li>
<li>session默认失效时间 30分钟<br> 选择性配置修改<br> &lt; session-config&gt;<pre><code>&lt; session-timeout&gt;30&lt; /session-timeout&gt;</code></pre> &lt; /session-config&gt;</li>
</ol>
</li>
</ol>
</li>
<li>session的特点<ul>
<li>session用于存储一次会话的多次请求的数据，存在服务器端</li>
<li>session可以存储任意类型，任意大小的数据</li>
</ul>
</li>
<li>session与Cookie的区别：<ul>
<li>session存储数据在服务器端，Cookie在客户端</li>
<li>session没有数据大小限制，Cookie有</li>
<li>session数据安全，Cookie相对于不安全</li>
</ul>
</li>
</ol>
<h2 id="案例：验证码"><a href="#案例：验证码" class="headerlink" title="案例：验证码"></a><strong>案例：验证码</strong></h2><ol>
<li>案例需求：<ol>
<li>访问带有验证码的登录页面login.jsp</li>
<li>用户输入用户名，密码以及验证码。<ul>
<li>如果用户名和密码输入有误，跳转登录页面，提示:用户名或密码错误</li>
<li>如果验证码输入有误，跳转登录页面，提示：验证码错误</li>
<li>如果全部输入正确，则跳转到主页success.jsp，显示：用户名,欢迎您</li>
</ul>
</li>
</ol>
</li>
<li>分析：</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tukuai.github.io/2020/03/25/Web/Session/" data-id="ckb22iuf5006kzwu8e24ngrkz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web/" rel="tag">Web</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Web/JSP" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/25/Web/JSP/" class="article-date">
  <time datetime="2020-03-25T07:28:33.000Z" itemprop="datePublished">2020-03-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/25/Web/JSP/">JSP</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="JSP：入门学习"><a href="#JSP：入门学习" class="headerlink" title="JSP：入门学习"></a><strong>JSP：入门学习</strong></h2><ol>
<li><p>概念：</p>
<ul>
<li>Java Server Pages： java服务器端页面<ul>
<li>可以理解为：一个特殊的页面，其中既可以指定定义html标签，又可以定义java代码</li>
<li>用于简化书写！！！</li>
</ul>
</li>
</ul>
</li>
<li><p>原理</p>
<ul>
<li>JSP本质上就是一个Servlet<br><img src="/images/155.png" alt=""></li>
</ul>
</li>
<li><p>JSP的脚本：JSP定义Java代码的方式</p>
<ol>
<li>&lt;%  代码 %&gt;：定义的java代码，在service方法中。service方法中可以定义什么，该脚本中就可以定义什么。</li>
<li>&lt;%! 代码 %&gt;：定义的java代码，在jsp转换后的java类的成员位置。</li>
<li>&lt;%= 代码 %&gt;：定义的java代码，会输出到页面上。输出语句中可以定义什么，该脚本中就可以定义什么。<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt; %</span><br><span class="line">       System.out.println(<span class="string">"hello jsp"</span>);</span><br><span class="line">       <span class="keyword">int</span> i = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">       String contextPath = request.getContextPath();													</span><br><span class="line">       out.print(contextPath);</span><br><span class="line">     % &gt;</span><br><span class="line"></span><br><span class="line">     &lt;%!</span><br><span class="line">       <span class="keyword">int</span> i = <span class="number">3</span>;</span><br><span class="line">     % &gt;</span><br><span class="line"></span><br><span class="line">     &lt;%= </span><br><span class="line">     <span class="string">"hello"</span> </span><br><span class="line">     % &gt;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>JSP的内置对象：</p>
<ul>
<li>在jsp页面中不需要获取和创建，可以直接使用的对象</li>
<li>jsp一共有9个内置对象。</li>
<li>今天学习3个：<ul>
<li>request</li>
<li>response</li>
<li>out：字符输出流对象。可以将数据输出到页面上。和response.getWriter()类似<ul>
<li>response.getWriter()和out.write()的区别：<ul>
<li>在tomcat服务器真正给客户端做出响应之前，会先找response缓冲区数据，再找out缓冲区数据。</li>
<li>response.getWriter()数据输出永远在out.write()之前</li>
<li>建议只使用一个，不建议使用response.getWriter()。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>案例:改造Cookie案例</p>
</li>
</ol>
<h2 id="JSP"><a href="#JSP" class="headerlink" title="JSP:"></a><strong>JSP:</strong></h2><h3 id="1-指令"><a href="#1-指令" class="headerlink" title="1.指令"></a><strong>1.指令</strong></h3><ul>
<li>作用：用于配置JSP页面，导入资源文件</li>
<li>格式：<br>  &lt;%@ 指令名称 属性名1=属性值1 属性名2=属性值2 … %&gt;</li>
<li>分类：<ol>
<li>page        ： 配置JSP页面的<ul>
<li>contentType：等同于response.setContentType()<ol>
<li>设置响应体的mime类型以及字符集</li>
<li>设置当前jsp页面的编码（只能是高级的IDE才能生效，如果使用低级工具，则需要设置pageEncoding属性设置当前页面的字符集）</li>
</ol>
</li>
<li>import：导包</li>
<li>errorPage：当前页面发生异常后，会自动跳转到指定的错误页面</li>
<li>isErrorPage：标识当前也是是否是错误页面。<ul>
<li>true：是，可以使用内置对象exception</li>
<li>false：否。默认值。不可以使用内置对象exception</li>
</ul>
</li>
</ul>
</li>
<li>include    ： 页面包含的。导入页面的资源文件<ul>
<li>&lt;%@include file=”top.jsp”%&gt;</li>
</ul>
</li>
<li>taglib    ： 导入资源<ul>
<li>&lt;%@ taglib prefix=”c” uri=”<a href="http://java.sun.com/jsp/jstl/core&quot;" target="_blank" rel="noopener">http://java.sun.com/jsp/jstl/core&quot;</a> %&gt;<ul>
<li>prefix：前缀，自定义的</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="2-注释"><a href="#2-注释" class="headerlink" title="2.注释:"></a><strong>2.注释:</strong></h3><ol>
<li>html注释： <!-- -->:只能注释html代码片段</li>
<li>jsp注释：推荐使用<br> &lt;%– –%&gt;：可以注释所有</li>
</ol>
<h3 id="3-内置对象"><a href="#3-内置对象" class="headerlink" title="3.内置对象"></a><strong>3.内置对象</strong></h3><ul>
<li><p>在jsp页面中不需要创建，直接使用的对象</p>
</li>
<li><p>一共有9个：</p>
<table>
<thead>
<tr>
<th>变量名</th>
<th>真实类型</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>pageContext</td>
<td>PageContext</td>
<td>当前页面共享数据，还可以获取其他八个内置对象</td>
</tr>
<tr>
<td>request</td>
<td>HttpServletRequest</td>
<td>一次请求访问的多个资源(转发)</td>
</tr>
<tr>
<td>session</td>
<td>HttpSession</td>
<td>一次会话的多个请求间</td>
</tr>
<tr>
<td>application</td>
<td>ServletContext</td>
<td>所有用户间共享数据</td>
</tr>
<tr>
<td>response</td>
<td>HttpServletResponse</td>
<td>响应对象</td>
</tr>
<tr>
<td>page</td>
<td>Object</td>
<td>当前页面(Servlet)的对象  this</td>
</tr>
<tr>
<td>out</td>
<td>JspWriter</td>
<td>输出对象，数据输出到页面上</td>
</tr>
<tr>
<td>config</td>
<td>ServletConfig</td>
<td>Servlet的配置对象</td>
</tr>
<tr>
<td>exception</td>
<td>Throwable</td>
<td>异常对象</td>
</tr>
</tbody></table>
</li>
</ul>
<h2 id="MVC：开发模式"><a href="#MVC：开发模式" class="headerlink" title="MVC：开发模式"></a><strong>MVC：开发模式</strong></h2><ol>
<li>jsp演变历史<ol>
<li>早期只有servlet，只能使用response输出标签数据，非常麻烦</li>
<li>后来又jsp，简化了Servlet的开发，如果过度使用jsp，在jsp中即写大量的java代码，又写html表，造成难于维护，难于分工协作</li>
<li>再后来，java的web开发，借鉴mvc开发模式，使得程序的设计更加合理性</li>
</ol>
</li>
<li>MVC：<ol>
<li>M：Model，模型。JavaBean<ul>
<li>完成具体的业务操作，如：查询数据库，封装对象</li>
</ul>
</li>
<li>V：View，视图。JSP<ul>
<li>展示数据</li>
</ul>
</li>
<li>C：Controller，控制器。Servlet<ul>
<li>获取用户的输入</li>
<li>调用模型</li>
<li>将数据交给视图进行展示</li>
</ul>
</li>
</ol>
<ul>
<li>优缺点：<ol>
<li>优点：<ol>
<li>耦合性低，方便维护，可以利于分工协作</li>
<li>重用性高</li>
</ol>
</li>
<li>缺点：<ol>
<li>使得项目架构变得复杂，对开发人员要求高<br><img src="/images/157.png" alt=""></li>
</ol>
</li>
</ol>
</li>
</ul>
</li>
</ol>
<h2 id="EL表达式"><a href="#EL表达式" class="headerlink" title="EL表达式"></a><strong>EL表达式</strong></h2><ol>
<li>概念：Expression Language 表达式语言</li>
<li>作用：替换和简化jsp页面中java代码的编写</li>
<li>语法：${表达式}</li>
<li>注意：<ul>
<li>jsp默认支持el表达式的。如果要忽略el表达式<ol>
<li>设置jsp中page指令中：isELIgnored=”true” 忽略当前jsp页面中所有的el表达式</li>
<li>${表达式} ：忽略当前这个el表达式</li>
</ol>
</li>
</ul>
</li>
<li>使用：<ol>
<li>运算：<ul>
<li>运算符：<ol>
<li>算数运算符： + - * /(div) %(mod)</li>
<li>比较运算符： &gt; &lt; &gt;= &lt;= == !=</li>
<li>逻辑运算符： &amp;&amp;(and) ||(or) !(not)</li>
<li>空运算符： empty<ul>
<li>功能：用于判断字符串、集合、数组对象是否为null或者长度是否为0</li>
<li>${empty list}:判断字符串、集合、数组对象是否为null或者长度为0</li>
<li>${not empty str}:表示判断字符串、集合、数组对象是否不为null 并且 长度&gt;0</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
<li>获取值<ol>
<li>el表达式只能从域对象中获取值</li>
<li>语法：<ol>
<li>${域名称.键名}：从指定域中获取指定键的值<ul>
<li>域名称：<ol>
<li>pageScope        –&gt; pageContext</li>
<li>requestScope     –&gt; request</li>
<li>sessionScope     –&gt; session</li>
<li>applicationScope –&gt; application（ServletContext）</li>
</ol>
</li>
<li>举例：在request域中存储了name=张三</li>
<li>获取：${requestScope.name}</li>
</ul>
</li>
<li>${键名}：表示依次从最小的域中查找是否有该键对应的值，直到找到为止。            </li>
<li>获取对象、List集合、Map集合的值<ol>
<li>对象：${域名称.键名.属性名}<ul>
<li>本质上会去调用对象的getter方法，因为找的是属性，而不是成员变量。</li>
</ul>
</li>
<li>List集合：${域名称.键名[索引]}</li>
<li>Map集合：<ul>
<li>${域名称.键名.key名称}</li>
<li>${域名称.键名[“key名称”]}</li>
</ul>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>隐式对象：<ul>
<li>el表达式中有11个隐式对象</li>
<li>pageContext：<ul>
<li>获取jsp其他八个内置对象<ul>
<li>${pageContext.request.contextPath}：动态获取虚拟目录</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
</ol>
<h2 id="JSTL"><a href="#JSTL" class="headerlink" title="JSTL"></a><strong>JSTL</strong></h2><ol>
<li><p>概念：JavaServer Pages Tag Library  JSP标准标签库</p>
<ul>
<li>是由Apache组织提供的开源的免费的jsp标签        &lt;标签&gt;</li>
</ul>
</li>
<li><p>作用：用于简化和替换jsp页面上的java代码        </p>
</li>
<li><p>使用步骤：</p>
<ol>
<li>导入jstl相关jar包</li>
<li>引入标签库：taglib指令： &lt;%@taglib prefix=”c” uri=”ht tp://java.sun.com/jsp/jstl/core” %&gt;</li>
<li>使用标签</li>
</ol>
</li>
<li><p>常用的JSTL标签</p>
<ol>
<li>if:相当于java代码的if语句<ol>
<li>属性：<ul>
<li>test 必须属性，接受boolean表达式<ul>
<li>如果表达式为true，则显示if标签体内容，如果为false，则不显示标签体内容</li>
<li>一般情况下，test属性值会结合el表达式一起使用</li>
</ul>
</li>
</ul>
<ol start="2">
<li>注意：<ul>
<li>c:if标签没有else情况，想要else情况，则可以在定义一个c:if标签<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> &lt;c:<span class="keyword">if</span> test=<span class="string">"$&#123;not empty list&#125;"</span>&gt;</span><br><span class="line">    遍历集合...</span><br><span class="line"></span><br><span class="line">&lt;/c:if&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
</li>
</ol>
</li>
<li>choose:相当于java代码的switch语句<ol>
<li>使用choose标签声明                     相当于switch声明</li>
<li>使用when标签做判断                     相当于case</li>
<li>使用otherwise标签做其他情况的声明        相当于default<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:choose&gt;</span><br><span class="line">    &lt;c:when test="$&#123;number == 1&#125;"&gt;星期一&lt;/c:when&gt;</span><br><span class="line">    &lt;c:when test="$&#123;number == 2&#125;"&gt;星期二&lt;/c:when&gt;</span><br><span class="line">    &lt;c:when test="$&#123;number == 3&#125;"&gt;星期三&lt;/c:when&gt;</span><br><span class="line">    &lt;c:when test="$&#123;number == 4&#125;"&gt;星期四&lt;/c:when&gt;</span><br><span class="line">    &lt;c:when test="$&#123;number == 5&#125;"&gt;星期五&lt;/c:when&gt;</span><br><span class="line">    &lt;c:when test="$&#123;number == 6&#125;"&gt;星期六&lt;/c:when&gt;</span><br><span class="line">    &lt;c:when test="$&#123;number == 7&#125;"&gt;星期天&lt;/c:when&gt;</span><br><span class="line"></span><br><span class="line">    &lt;c:otherwise&gt;数字输入有误&lt;/c:otherwise&gt;</span><br><span class="line">&lt;/c:choose&gt;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li>foreach:相当于java代码的for语句<ol>
<li>完成重复的操作<ul>
<li>属性：<br>begin：开始值<br>end：结束值<br>var：临时变量<br>step：步长<br>varStatus:循环状态对象<br> index:容器中元素的索引，从0开始<br> count:循环次数，从1开始</li>
</ul>
</li>
<li>遍历容器      <ul>
<li>属性：<br>  items:容器对象<br>  var:容器中元素的临时变量<br>  varStatus:循环状态对象<pre><code>index:容器中元素的索引，从0开始
count:循环次数，从1开始</code></pre><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:forEach begin=<span class="string">"1"</span> end=<span class="string">"10"</span> <span class="keyword">var</span>=<span class="string">"i"</span> step=<span class="string">"2"</span> varStatus=<span class="string">"s"</span>&gt;</span><br><span class="line">$&#123;i&#125;		 &lt;h3&gt;$&#123;s.index&#125;&lt;h3&gt; 		&lt;h4&gt;$&#123;s.count&#125;&lt;/h4&gt;		&lt;br&gt;</span><br><span class="line">/c:forEach&gt;</span><br><span class="line"></span><br><span class="line">&lt;c:forEach items=<span class="string">"$&#123;list&#125;"</span> <span class="keyword">var</span>=<span class="string">"str"</span> varStatus=<span class="string">"s"</span>&gt;</span><br><span class="line"></span><br><span class="line">            $&#123;s.index&#125; $&#123;s.count&#125; $&#123;str&#125;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
</li>
</ol>
</li>
<li><p>练习：</p>
<ul>
<li>需求：在request域中有一个存有User对象的List集合。需要使用jstl+el将list集合数据展示到jsp页面的表格table中<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;table border=<span class="string">"1"</span> width=<span class="string">"500"</span> align=<span class="string">"center"</span>&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;th&gt;编号&lt;<span class="regexp">/th&gt;</span></span><br><span class="line"><span class="regexp">        &lt;th&gt;姓名&lt;/</span>th&gt;</span><br><span class="line">        &lt;th&gt;年龄&lt;<span class="regexp">/th&gt;</span></span><br><span class="line"><span class="regexp">        &lt;th&gt;生日&lt;/</span>th&gt;</span><br><span class="line">    &lt;<span class="regexp">/tr&gt;</span></span><br><span class="line"><span class="regexp">    &lt;%--数据行--%&gt;</span></span><br><span class="line"><span class="regexp">    &lt;c:forEach items="$&#123;list&#125;" var="user" varStatus="s"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;c:if test="$&#123;s.count % 2 != 0&#125;"&gt;</span></span><br><span class="line"><span class="regexp">            &lt;tr bgcolor="red"&gt;</span></span><br><span class="line"><span class="regexp">                &lt;td&gt;$&#123;s.count&#125;&lt;/</span>td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;user.name&#125;&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">                &lt;td&gt;$&#123;user.age&#125;&lt;/</span>td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;user.birStr&#125;&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>tr&gt;</span><br><span class="line">        &lt;<span class="regexp">/c:if&gt;</span></span><br><span class="line"><span class="regexp">        &lt;c:if test="$&#123;s.count % 2 == 0&#125;"&gt;</span></span><br><span class="line"><span class="regexp">            &lt;tr  bgcolor="green"&gt;</span></span><br><span class="line"><span class="regexp">                &lt;td&gt;$&#123;s.count&#125;&lt;/</span>td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;user.name&#125;&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">                &lt;td&gt;$&#123;user.age&#125;&lt;/</span>td&gt;</span><br><span class="line">                &lt;td&gt;$&#123;user.birStr&#125;&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>tr&gt;</span><br><span class="line">        &lt;<span class="regexp">/c:if&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>c:forEach&gt;</span><br></pre></td></tr></table></figure>




</li>
</ul>
</li>
</ol>
<h2 id="三层架构：软件设计架构"><a href="#三层架构：软件设计架构" class="headerlink" title="三层架构：软件设计架构"></a><strong>三层架构：软件设计架构</strong></h2><ol>
<li>界面层(表示层)：用户看的得界面。用户可以通过界面上的组件和服务器进行交互</li>
<li>业务逻辑层：处理业务逻辑的。</li>
<li>数据访问层：操作数据存储文件。<br><img src="/images/158.png" alt=""></li>
</ol>
<h2 id="案例：用户信息列表展示"><a href="#案例：用户信息列表展示" class="headerlink" title="案例：用户信息列表展示"></a><strong>案例：用户信息列表展示</strong></h2><ol>
<li>需求：用户信息的增删改查操作</li>
<li>设计：<ol>
<li>技术选型：Servlet+JSP+MySQL+JDBCTempleat+Druid+BeanUtilS+tomcat</li>
<li>数据库设计：<br> create database day17; – 创建数据库<br> use day17;                – 使用数据库<br> create table user(   – 创建表<pre><code>id int primary key auto_increment,
name varchar(20) not null,
gender varchar(5),
age int,
address varchar(32),
qq    varchar(20),
email varchar(50)</code></pre> );</li>
</ol>
</li>
<li>开发：<ol>
<li>环境搭建<ol>
<li>创建数据库环境</li>
<li>创建项目，导入需要的jar包</li>
</ol>
</li>
<li>编码</li>
</ol>
</li>
<li>测试</li>
<li>部署运维<br><img src="/images/159.png" alt=""></li>
</ol>
<h2 id="综合练习"><a href="#综合练习" class="headerlink" title="综合练习"></a><strong>综合练习</strong></h2><ol>
<li>简单功能<ol>
<li>列表查询</li>
<li>登录</li>
<li>添加</li>
<li>删除</li>
<li>修改        </li>
</ol>
</li>
<li>复杂功能<ol>
<li>删除选中</li>
<li>分页查询<ul>
<li>好处：<ol>
<li>减轻服务器内存的开销</li>
<li>提升用户体验</li>
</ol>
</li>
</ul>
</li>
<li>复杂条件查询</li>
</ol>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tukuai.github.io/2020/03/25/Web/JSP/" data-id="ckb22iuey005uzwu89157dsyg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web/" rel="tag">Web</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Web/Cookie" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/25/Web/Cookie/" class="article-date">
  <time datetime="2020-03-25T02:14:32.000Z" itemprop="datePublished">2020-03-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/25/Web/Cookie/">Cookie</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="会话技术"><a href="#会话技术" class="headerlink" title="会话技术"></a><strong>会话技术</strong></h2><ol>
<li>会话：一次会话中包含多次请求和响应。<ul>
<li>一次会话：浏览器第一次给服务器资源发送请求，会话建立，直到有一方断开为止</li>
</ul>
</li>
<li>功能：在一次会话的范围内的多次请求间，共享数据</li>
<li>方式：<ol>
<li>客户端会话技术：Cookie</li>
<li>服务器端会话技术：Session</li>
</ol>
</li>
</ol>
<h2 id="Cookie："><a href="#Cookie：" class="headerlink" title="Cookie："></a><strong>Cookie：</strong></h2><h3 id="1-概念"><a href="#1-概念" class="headerlink" title="1.概念"></a><strong>1.概念</strong></h3><p>客户端会话技术，将数据保存到客户端<br><strong>注意</strong>：只有在同一个浏览器，才会有相同的Cookie通信。</p>
<h3 id="2-快速入门"><a href="#2-快速入门" class="headerlink" title="2.快速入门"></a><strong>2.快速入门</strong></h3><ol>
<li>创建Cookie对象，绑定数据<ul>
<li>new Cookie(String name, String value) </li>
</ul>
</li>
<li>发送Cookie对象<ul>
<li>response.addCookie(Cookie cookie) </li>
</ul>
</li>
<li>获取Cookie，拿到数据<ul>
<li>Cookie[]  request.getCookies()  </li>
</ul>
</li>
</ol>
<h3 id="3-实现原理"><a href="#3-实现原理" class="headerlink" title="3.实现原理"></a><strong>3.实现原理</strong></h3><ul>
<li>基于响应头set-cookie和请求头cookie实现</li>
</ul>
<h3 id="4-cookie的细节"><a href="#4-cookie的细节" class="headerlink" title="4.cookie的细节"></a><strong>4.cookie的细节</strong></h3><ol>
<li><p>一次可不可以发送多个cookie?</p>
<ul>
<li>可以</li>
<li>可以创建多个Cookie对象，使用response调用多次addCookie方法发送cookie即可。</li>
</ul>
</li>
<li><p>cookie在浏览器中保存多长时间？</p>
<ol>
<li>默认情况下，当浏览器关闭后，Cookie数据被销毁</li>
<li>持久化存储：<ul>
<li>setMaxAge(int seconds)<ol>
<li>正数：将Cookie数据写到硬盘的文件中。持久化存储。并指定cookie存活时间，时间到后，cookie文件自动失效</li>
<li>负数：默认值</li>
<li>零：删除cookie信息</li>
</ol>
</li>
</ul>
</li>
</ol>
</li>
<li><p>cookie能不能存中文？</p>
<ul>
<li>在tomcat 8 之前 cookie中不能直接存储中文数据。<ul>
<li>需要将中文数据转码—一般采用URL编码(%E3)</li>
</ul>
</li>
<li>在tomcat 8 之后，cookie支持中文数据。特殊字符还是不支持，建议使用URL编码存储，URL解码解析</li>
</ul>
</li>
<li><p>cookie共享问题？</p>
<ol>
<li><p>假设在一个tomcat服务器中，部署了多个web项目，那么在这些web项目中cookie能不能共享？</p>
<ul>
<li>默认情况下cookie不能共享</li>
<li>setPath(String path):设置cookie的获取范围。默认情况下，设置当前的虚拟目录<ul>
<li>如果要共享，则可以将path设置为”/“</li>
</ul>
</li>
</ul>
</li>
<li><p>不同的tomcat服务器间cookie共享问题？</p>
<ul>
<li>setDomain(String path):如果设置一级域名相同，那么多个服务器之间cookie可以共享<ul>
<li>setDomain(“.baidu.com”),那么tieba.baidu.com和news.baidu.com中cookie可以共享</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
</ol>
<h3 id="5-Cookie的特点和作用"><a href="#5-Cookie的特点和作用" class="headerlink" title="5.Cookie的特点和作用"></a><strong>5.Cookie的特点和作用</strong></h3><ol>
<li>cookie存储数据在客户端浏览器</li>
<li>浏览器对于单个cookie 的大小有限制(4kb) 以及 对同一个域名下的总cookie数量也有限制(20个)</li>
</ol>
<ul>
<li>作用：<ol>
<li>cookie一般用于存出少量的不太敏感的数据</li>
<li>在不登录的情况下，完成服务器对客户端的身份识别</li>
</ol>
</li>
</ul>
<h3 id="6-案例：记住上一次访问时间"><a href="#6-案例：记住上一次访问时间" class="headerlink" title="6.案例：记住上一次访问时间"></a><strong>6.案例：记住上一次访问时间</strong></h3><ol>
<li>需求：<ol>
<li>访问一个Servlet，如果是第一次访问，则提示：您好，欢迎您首次访问。</li>
<li>如果不是第一次访问，则提示：欢迎回来，您上次访问时间为:显示时间字符串</li>
</ol>
</li>
<li>分析：<ol>
<li>可以采用Cookie来完成</li>
<li>在服务器中的Servlet判断是否有一个名为lastTime的cookie<ol>
<li>有：不是第一次访问<ol>
<li>响应数据：欢迎回来，您上次访问时间为:2018年6月10日11:50:20</li>
<li>写回Cookie：lastTime=2018年6月10日11:50:01</li>
</ol>
</li>
<li>没有：是第一次访问<ol>
<li>响应数据：您好，欢迎您首次访问</li>
<li>写回Cookie：lastTime=2018年6月10日11:50:01</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>代码实现：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet</span>(<span class="string">"/cookieTest"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CookieTest</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//设置响应的消息体的数据格式以及编码</span></span><br><span class="line">        response.setContentType(<span class="string">"text/html;charset=utf-8"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.获取所有Cookie</span></span><br><span class="line">        Cookie[] cookies = request.getCookies();</span><br><span class="line">        <span class="keyword">boolean</span> flag = <span class="keyword">false</span>;<span class="comment">//没有cookie为lastTime</span></span><br><span class="line">        <span class="comment">//2.遍历cookie数组</span></span><br><span class="line">        <span class="keyword">if</span>(cookies != <span class="keyword">null</span> &amp;&amp; cookies.length &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span> (Cookie cookie : cookies) &#123;</span><br><span class="line">                <span class="comment">//3.获取cookie的名称</span></span><br><span class="line">                String name = cookie.getName();</span><br><span class="line">                <span class="comment">//4.判断名称是否是：lastTime</span></span><br><span class="line">                <span class="keyword">if</span>(<span class="string">"lastTime"</span>.equals(name))&#123;</span><br><span class="line">                    <span class="comment">//有该Cookie，不是第一次访问</span></span><br><span class="line"></span><br><span class="line">                    flag = <span class="keyword">true</span>;<span class="comment">//有lastTime的cookie</span></span><br><span class="line">                    <span class="comment">//获取Cookie的value，时间</span></span><br><span class="line">                    String value = cookie.getValue();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="comment">//设置Cookie的value</span></span><br><span class="line">                    <span class="comment">//获取当前时间的字符串，重新设置Cookie的值，重新发送cookie</span></span><br><span class="line">                    Date date  = <span class="keyword">new</span> Date();</span><br><span class="line">                    SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy年MM月dd日 HH:mm:ss"</span>);</span><br><span class="line">                    String str_date = sdf.format(date);</span><br><span class="line">                    System.out.println(<span class="string">"编码前："</span>+str_date);</span><br><span class="line">                    <span class="comment">//URL编码</span></span><br><span class="line">                    str_date = URLEncoder.encode(str_date,<span class="string">"utf-8"</span>);</span><br><span class="line">                    System.out.println(<span class="string">"编码后："</span>+str_date);</span><br><span class="line">                    cookie.setValue(str_date);</span><br><span class="line">                    <span class="comment">//设置cookie的存活时间</span></span><br><span class="line">                    cookie.setMaxAge(<span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span>);<span class="comment">//一个月</span></span><br><span class="line">                    response.addCookie(cookie);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="comment">//响应数据                   </span></span><br><span class="line">                    System.out.println(<span class="string">"解码前："</span>+value);</span><br><span class="line">                    <span class="comment">//URL解码：</span></span><br><span class="line">                    value = URLDecoder.decode(value,<span class="string">"utf-8"</span>);</span><br><span class="line">                    System.out.println(<span class="string">"解码后："</span>+value);</span><br><span class="line">                    response.getWriter().write(<span class="string">"&lt;h1&gt;欢迎回来，您上次访问时间为:"</span>+value+<span class="string">"&lt;/h1&gt;"</span>);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(cookies == <span class="keyword">null</span> || cookies.length == <span class="number">0</span> || flag == <span class="keyword">false</span>)&#123;</span><br><span class="line">            <span class="comment">//没有，第一次访问</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//设置Cookie的value</span></span><br><span class="line">            <span class="comment">//获取当前时间的字符串，重新设置Cookie的值，重新发送cookie</span></span><br><span class="line">            Date date  = <span class="keyword">new</span> Date();</span><br><span class="line">            SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy年MM月dd日 HH:mm:ss"</span>);</span><br><span class="line">            String str_date = sdf.format(date);</span><br><span class="line">            System.out.println(<span class="string">"编码前："</span>+str_date);</span><br><span class="line">            <span class="comment">//URL编码</span></span><br><span class="line">            str_date = URLEncoder.encode(str_date,<span class="string">"utf-8"</span>);</span><br><span class="line">            System.out.println(<span class="string">"编码后："</span>+str_date);</span><br><span class="line"></span><br><span class="line">            Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">"lastTime"</span>,str_date);</span><br><span class="line">            <span class="comment">//设置cookie的存活时间</span></span><br><span class="line">            cookie.setMaxAge(<span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span>);<span class="comment">//一个月</span></span><br><span class="line">            response.addCookie(cookie);</span><br><span class="line"></span><br><span class="line">            response.getWriter().write(<span class="string">"&lt;h1&gt;您好，欢迎您首次访问&lt;/h1&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.doPost(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tukuai.github.io/2020/03/25/Web/Cookie/" data-id="ckb22iuev005jzwu8bhmi3o4y" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web/" rel="tag">Web</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-算法/马踏棋盘算法" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/19/%E7%AE%97%E6%B3%95/%E9%A9%AC%E8%B8%8F%E6%A3%8B%E7%9B%98%E7%AE%97%E6%B3%95/" class="article-date">
  <time datetime="2020-03-19T14:14:40.000Z" itemprop="datePublished">2020-03-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/19/%E7%AE%97%E6%B3%95/%E9%A9%AC%E8%B8%8F%E6%A3%8B%E7%9B%98%E7%AE%97%E6%B3%95/">马踏棋盘算法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="算法十：马踏棋盘算法"><a href="#算法十：马踏棋盘算法" class="headerlink" title="算法十：马踏棋盘算法"></a><strong>算法十：马踏棋盘算法</strong></h2><p>1.马踏棋盘算法也被称为骑士周游问题<br>2.将马随机放在国际象棋的8×8棋盘Board[0～7][0～7]的某个方格中，马按走棋规则(马走日字)进行移动。要求每个方格只进入一次，走遍棋盘上全部64个方格<br>3.游戏演示: <a href="http://www.4399.com/flash/146267_2.htm" target="_blank" rel="noopener">http://www.4399.com/flash/146267_2.htm</a><br><img src="/images/99.png" alt=""><br>1.马踏棋盘问题(骑士周游问题)实际上是图的深度优先搜索(DFS)的应用。<br>2.如果使用回溯（就是深度优先搜索）来解决，假如马儿踏了53个点，如图：走到了第53个，坐标（1,0），发现已经走到尽头，没办法，那就只能回退了，查看其他的路径，就在棋盘上不停的回溯…… ，思路分析+代码实现<br>3.分析第一种方式的问题，并使用贪心算法（greedyalgorithm）进行优化（改变选择下一步的策略，要求下一步的下一步可走的选择最少，所以递归的次数就会比较少）。解决马踏棋盘问题.<br><strong>贪心算法优化非常重要，不然速度会非常慢</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;马踏棋盘问题</span><br><span class="line">public class MaTaQiPanDemo &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        MaTaQiPan m&#x3D;new MaTaQiPan(8);</span><br><span class="line">        System.out.println(&quot;骑士周游算法开始运行&quot;);</span><br><span class="line">        long start&#x3D;System.currentTimeMillis();</span><br><span class="line">        m.go(0,0,1);</span><br><span class="line">        long end&#x3D;System.currentTimeMillis();</span><br><span class="line">        System.out.println(end-start);</span><br><span class="line">        for (int[] ints : m.qipan) &#123;</span><br><span class="line">            for (int i : ints) &#123;</span><br><span class="line">                System.out.print(i+&quot;\t&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class MaTaQiPan</span><br><span class="line">&#123;</span><br><span class="line">    int[][] qipan;</span><br><span class="line">    int size;</span><br><span class="line">    int nums;</span><br><span class="line">    int [][] visited;</span><br><span class="line">    boolean finished&#x3D;false;</span><br><span class="line">    MaTaQiPan(int size)</span><br><span class="line">    &#123;</span><br><span class="line">        this.size&#x3D;size;</span><br><span class="line">        qipan&#x3D;new int[size][size];</span><br><span class="line">        visited&#x3D;new int[size][size];</span><br><span class="line">        nums&#x3D;size*size;</span><br><span class="line">    &#125;</span><br><span class="line">    public void go(int i,int j,int num)</span><br><span class="line">    &#123;</span><br><span class="line">       visited[i][j]&#x3D;1;</span><br><span class="line">       qipan[i][j]&#x3D;num;</span><br><span class="line">        ArrayList&lt;Point&gt; ps &#x3D; getSetp(new Point(i, j));</span><br><span class="line">        sort(ps);</span><br><span class="line">        while(!ps.isEmpty())</span><br><span class="line">        &#123;</span><br><span class="line">            Point p&#x3D;ps.remove(0);</span><br><span class="line">            if(visited[p.x][p.y]&#x3D;&#x3D;0)</span><br><span class="line">            &#123;</span><br><span class="line">                go(p.x,p.y,num+1);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F;回溯的灵魂所在，若是达到了第size*size步,则设置finished为true，然后回溯过程中visited[i][j]就不会被重置，</span><br><span class="line">        &#x2F;&#x2F; 若是步数还没到size*size且finished为false，则表明此路不通</span><br><span class="line">        if(num&lt;nums&amp;&amp;!finished)</span><br><span class="line">        &#123;</span><br><span class="line">            visited[i][j]&#x3D;0;</span><br><span class="line">        &#125;</span><br><span class="line">        else finished&#x3D;true;</span><br><span class="line">    &#125;</span><br><span class="line">    public ArrayList&lt;Point&gt; getSetp(Point p)</span><br><span class="line">    &#123;</span><br><span class="line">        ArrayList&lt;Point&gt; ap&#x3D;new ArrayList&lt;&gt;();</span><br><span class="line">        if(p.x-2&gt;&#x3D;0&amp;&amp;p.y-1&gt;&#x3D;0)</span><br><span class="line">            ap.add(new Point(p.x-2,p.y-1));</span><br><span class="line">        if(p.x-1&gt;&#x3D;0&amp;&amp;p.y-2&gt;&#x3D;0)</span><br><span class="line">            ap.add(new Point(p.x-1,p.y-2));</span><br><span class="line">        if(p.x+1&lt;size&amp;&amp;p.y-2&gt;&#x3D;0)</span><br><span class="line">            ap.add(new Point(p.x+1,p.y-2));</span><br><span class="line">        if(p.x+2&lt;size&amp;&amp;p.y-1&gt;&#x3D;0)</span><br><span class="line">            ap.add(new Point(p.x+2,p.y-1));</span><br><span class="line">        if(p.x+2&lt;size&amp;&amp;p.y+1&lt;size)</span><br><span class="line">            ap.add(new Point(p.x+2,p.y+1));</span><br><span class="line">        if(p.x+1&lt;size&amp;&amp;p.y+2&lt;size)</span><br><span class="line">            ap.add(new Point(p.x+1,p.y+2));</span><br><span class="line">        if(p.x-1&gt;&#x3D;0&amp;&amp;p.y+2&lt;size)</span><br><span class="line">            ap.add(new Point(p.x-1,p.y+2));</span><br><span class="line">        if(p.x-2&gt;&#x3D;0&amp;&amp;p.y+1&lt;size)</span><br><span class="line">            ap.add(new Point(p.x-2,p.y+1));</span><br><span class="line">        &#x2F;&#x2F;sort(ap);</span><br><span class="line">        return ap;</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F;根据当前这一步的所有下一步的选择位置进行排序</span><br><span class="line">    public void sort(ArrayList&lt;Point&gt; ps)</span><br><span class="line">    &#123;</span><br><span class="line">        ps.sort(new Comparator&lt;Point&gt;() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            &#x2F;&#x2F;o1,o2,为当前步的下一步可选的位置，比较o1和o2的下一步的个数，并进行递增排序</span><br><span class="line">            public int compare(Point o1, Point o2) &#123;</span><br><span class="line">                int c1&#x3D;getSetp(o1).size();</span><br><span class="line">                int c2&#x3D;getSetp(o2).size();</span><br><span class="line">                    return c1-c2;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://tukuai.github.io/2020/03/19/%E7%AE%97%E6%B3%95/%E9%A9%AC%E8%B8%8F%E6%A3%8B%E7%9B%98%E7%AE%97%E6%B3%95/" data-id="ckb22iugk00c4zwu857md6l5t" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-计算机网络/第五层-应用层" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/15/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%AC%AC%E4%BA%94%E5%B1%82-%E5%BA%94%E7%94%A8%E5%B1%82/" class="article-date">
  <time datetime="2020-03-15T15:43:25.000Z" itemprop="datePublished">2020-03-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/15/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%AC%AC%E4%BA%94%E5%B1%82-%E5%BA%94%E7%94%A8%E5%B1%82/">第五层-应用层</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="应用层概述"><a href="#应用层概述" class="headerlink" title="应用层概述"></a><strong>应用层概述</strong></h2><p>很多应用系统的完成需要依靠位于不同端（主机）系统中进程之间的相互通信和协同。<br>事实上，计算机网络系统的出现及发展本身就是为了实现不同端系统之间的信息交互和协同。</p>
<p><strong>1.应用层与应用层协议</strong></p>
<blockquote>
<p>应用层协议不是应用程序，也不解决用户的具体应用需求，而是为应用程序进程的网络通信提供服务的第一层协议，是为用户的应用需求提供通信服务。<br>根据服务的对象，应体应用程序的需求提供通用的、标准化的通信平台，以沟通传输层及其以下网络层次的网络通信协议。<br>因此，应用层协议定义了运行在不同端系统上的应用程序进程相互传递报文的规范。这些规范一般包括：<br>交换的报文类型，如请求报文和响应报文<br>语法，如报文中的各个字段及这些字段的描述规范<br>语义，即报文各字段的可能取值及其含义<br>进程何时、如何发送报文及对报文进行响应。</p>
</blockquote>
<p><strong>2.应用层协议的体系架构</strong></p>
<blockquote>
<p>1）客户-服务器模式<br>服务器：需要具备7* 24小时提供服务的能力，拥有可永久访问地址/域名，以及拥有良好的可扩展性。<br>客户端：可以间歇性进入网络，客户端之间通常不直接连接。<br>2）P to P模式<br>对等性：通信的各方地位平等，互为客户端也互为服务器。<br>独立性：对中心服务器依赖最小（甚至没有）。应用程序在间歇性连接的主机之间直接通信，相互提供对方需要的服务。<br>3）混合模式<br>一种混合了C/S和P2P的通信模式，兼具二者特点。<br>服务器：负责全局性的服务，如搜索等。<br>客户端：负责提供具体的服务。</p>
</blockquote>
<p><strong>3.对传输层的要求</strong><br>不同的应用程序，对传输层有不同的要求。有些对时间敏感，有些对数据敏感。</p>
<blockquote>
<p>1）可靠数据传输<br>有些应用程序要求确保可靠性，而也有些应用程序能够容忍一定程度的数据丢失(Loss-Tolerant Application，容忍丢失应用) ，如多媒体应用。<br>2）吞吐量<br>具有吞吐量要求的应用程序被称为带宽敏感应用 (Bandwidth-Sensitive Application)，许多多媒体应用是带宽敏感度。<br>弹性应用 (Alastic Application) 则能够根据情况或多或少地利用可供使用的吞吐量。电子邮件、文件传输以及Web传送都属于弹性应用。<br>3）定时<br>在网络电话中，较长的时延会导致会话出现不自然的停顿；在游戏中，较长的时延使得它失去真实感。<br>4）安全性<br>可以提供一种或多种安全性服务。<br><strong>TCP服务</strong><br>面向连接的服务，全双工<br>可靠的数据传送服务：无差错，按适当顺序交付所有发送的数据<br>拥塞控制机制：当发送方和接收方之间的网络出现拥塞时，TCP会抑制发送进程<br>安全套接字层 SSL 提供安全性服务<br><strong>UDP服务</strong><br>提供最小服务<br>无连接<br>不可靠数据传送服务<br>在TCP/IP的传输层协议中不提供吞吐量和定时服务</p>
</blockquote>
<p><strong>4.TCP/IP中的应用层协议</strong></p>
<blockquote>
<p>TCP/IP协议簇提供了一些常用的公共应用层协议。<br>域名解析协议            超文本传输协议<br>电子邮件协议            会话发起协议<br>文件传输协议            远程访问协议</p>
</blockquote>
<h2 id="域名解析协议"><a href="#域名解析协议" class="headerlink" title="域名解析协议"></a><strong>域名解析协议</strong></h2><p>域名解析协议，有很多别称，如因特网的目录服务、域名服务、域名系统（Domain Name System，DNS）等，常常用简称DNS替代。<br>DNS用来解决主机名与IP地址的映射关系，使互联网用户无需记忆相对难于记忆的IP地址，而只要记住更加接近人类理解特性的域名即可。<br>因此，互联网用户对DNS有极强的依赖性。</p>
<ol>
<li>域名及域名结构<br>通过采用层次结构的命名方法确保域名的唯一性，从而可以唯一的指明某个域名对应的主机的IP地址。<br>按照层次结构，域名分为：<br>顶级域名<br>二级域名<br>三级域名<br>四级域名<br>…<br>级别最低的域名自左至右逐步上升。<br>… . 三级域名 . 二级域名 . 顶级域名.</li>
</ol>
<p><strong>绝对域名</strong><br>以点“.”结尾的域名称为绝对域名或完全合格的域名（Full Qualified Domain Name，FQDN），不以点结尾，则是不完全的域名。<br>如果不完全的域名是由两个或两个以上的标号组成，则认为是完全域名；<br>如果在不完全的域名右部连接一个局部后缀，也认为是完全域名。<br><strong>域名只是个逻辑概念，并不代表计算机所在的物理地点。<br>变长的域名和使用有助记忆的字符串，是为了便于人来使用。而 IP 地址是定长的 32 位二进制数字则非常便于机器进行处理。</strong><br>域名中的“点”和点分十进制 IP 地址中的“点”并无一一对应的关系。点分十进制 IP地址中一定是包含三个“点”，但每一个域名中“点”的数目则不一定正好是三个。 </p>
<ol start="2">
<li><p>顶级域名 TLD (Top Level Domain)<br>1）通用域名<br>通用域名共有7个，均为三个字节长度，分别是.com、.net、.org、.edu、.gov、.mil、.int<br>其中，.gov、.mil两个顶级域名为美国专用，.edu基本只有美国的教育机构使用<br>2）国家域名<br>例如：cn（中国大陆）、de（德国）、eu（欧盟）、jp（日本）、hk（香港）、tw（台湾）、uk（英国）、us（美国）。<br>3）arpa域<br>这种顶级域名只有一个，即 arpa，用于反向域名解析，因此又称为反向域名。<br>4）新增通用顶级域名 </p>
</li>
<li><p>域名服务器<br>域名需要由遍及全世界的域名服务器去解析，域名服务器实际上就是装有域名系统的主机。<br>一个服务器所负责管辖的（或有权限的）范围叫做区(zone)。<br>各单位根据具体情况来划分自己管辖范围的区。但在一个区中的所有节点必须是能够连通的。<br>每一个区设置相应的权限域名服务器，用来保存该区中的所有主机的域名到IP地址的映射。<br>DNS 服务器的管辖范围不是以“域”为单位，而是以“区”为单位。  </p>
</li>
<li><p>域名服务器的可靠性<br>DNS 域名服务器都把数据复制到几个域名服务器来保存，其中的一个是主域名服务器，其他的是辅助域名服务器。<br>当主域名服务器出故障时，辅助域名服务器可以保证 DNS 的查询工作不会中断。<br>主域名服务器定期把数据复制到辅助域名服务器中，而更改数据只能在主域名服务器中进行。这样就保证了数据的一致性。 </p>
</li>
<li><p>域名解析过程<br>1) 解析步骤<br>主机向本地域名服务器的查询一般都是采用递归查询。<br>本地域名服务器向根域名服务器的查询通常是采用迭代查询。</p>
</li>
</ol>
<p>2.)解析过程<br>首先从主机本地Hosts文件查找。没找到就向本地DNS发出请求；<br>若本地DNS也找不到，则将请求发给负责该域的根域名字服务器，根服务器会返回一个相应的顶级域名服务器地址；<br>本地域名服务器向顶级域名服务器提出请求。顶级域名服务器会返回一个权限域名服务器地址；<br>本地域名服务器向权限域名服务器提出请求，权限域名服务器将返回目标域名的IP地址。<br>本地域名服务器向查询主机返回目标域名的IP地址。</p>
<p>3)名字的高速缓存<br>每个域名服务器都维护一个高速缓存，存放最近用过的名字以及从何处获得名字映射信息的记录。<br>可大大减轻根域名服务器的负荷，使因特网上的 DNS 查询请求和回答报文的数量大为减少。 </p>
<ol start="6">
<li>UDP还是TCP<br>DNS使用的传输层承载协议既可以是UDP也可以是TCP，且端口号均为53.<br>在大部分情况下，DNS采用UDP协议。但是，当遇到以下情况时，采用TCP：<br>由于DNS主要使用UDP，而且查询和响应通常经过广域网，分组丢失率和往返时间的不确定性很难控制。因此，在DNS客户端程序中，处理好重传和超时程序就显得十分重要。</li>
</ol>
<h2 id="电子邮件协议"><a href="#电子邮件协议" class="headerlink" title="电子邮件协议"></a><strong>电子邮件协议</strong></h2><p>电子邮件不仅使用方便，而且还具有传递迅速和费用低廉的优点。</p>
<ol>
<li>电子邮件的一些标准<br>发送邮件的协议：SMTP<br>读取邮件的协议：POP3 和 IMAP<br>MIME 在其邮件首部中说明了邮件的数据类型(如文本、声音、图像、视像等)，使用 MIME 可在邮件中同时传送多种类型的数据。 </li>
</ol>
<p>协议</p>
<ol>
<li>简单邮件传送协议（Simple Mail Transfer Protocol，SMTP）<br>SMTP 所规定的就是在两个相互通信的 SMTP 进程之间应如何交换信息。<br>由于 SMTP 使用客户服务器方式，因此负责发送邮件的 SMTP 进程就是 SMTP 客户，而负责接收邮件的 SMTP 进程就是 SMTP 服务器。</li>
<li>邮件读取协议<br>1）POP3协议<br>POP3是Post Office Protocol 版本3的简称，是TCP/IP协议簇中的一员（默认端口是110）。POP3协议主要用于支持使用客户端远程管理在服务器上的电子邮件。POP3规定怎样将主机连接到Internet的邮件服务器和下载电子邮件的电子协议。<br>POP3的先天缺陷：<br>即当用户接收电子邮件时，所有的信件都从服务器上清除并下载到客户机。在整个收信过程中，用户无法知道邮件的具体信息，只有照单全收入硬盘后，才能慢慢浏览和删除。</li>
</ol>
<p>2）IMAP 协议<br>Internet邮件访问协议（Internet Mail Access Protocol，IMAP），以前称为交互式邮件访问协议（Interactive Mail Access Protocol），目前为版本4，IMAP4。<br>和POP3一样，IMAP也是一个用于接收邮件的协议。和POP3最明显的不同是：用户既可以通过客户端在线或者离线访问邮件服务器上的邮件，也能交互式的操作邮件服务器上的邮件，从而可以不需要将邮件下载到本地。</p>
<p>3）必须注意<br>不要将邮件读取协议 POP 或 IMAP 与邮件传送协议 SMTP 弄混。<br>发信人的用户代理向源邮件服务器发送邮件，以及源邮件服务器向目的邮件服务器发送邮件，都是使用 SMTP 协议。<br>而 POP 协议或 IMAP 协议则是用户从目的邮件服务器上读取邮件所使用的协议。 </p>
<h3 id="万维网-WWW"><a href="#万维网-WWW" class="headerlink" title="万维网 WWW"></a><strong>万维网 WWW</strong></h3><p>万维网概述<br>万维网 WWW (World Wide Web)并非某种特殊的计算机网络。<br>万维网是一个大规模的、联机式的信息储藏所。<br>万维网用链接的方法能非常方便地从因特网上的一个站点访问另一个站点，从而主动地按需获取丰富的信息。<br>这种访问方式称为“链接”。</p>
<p>万维网是分布式超媒体(hypermedia)系统，是超文本(hypertext)系统的扩充。<br>一个超文本由多个信息源链接成。利用一个链接可使用户找到另一个文档。这些文档可以位于世界上任何一个接在因特网上的超文本系统中。超文本是万维网的基础。<br>超媒体与超文本的区别是文档内容不同。超文本文档仅包含文本信息，而超媒体文档还包含其他表示方式的信息，如图形、图像、声音、动画，甚至活动视频图像。</p>
<p>万维网的工作方式<br>万维网以客户服务器方式工作。<br>浏览器就是在用户计算机上的万维网客户程序。万维网文档所驻留的计算机则运行服务器程序，因此这个计算机也称为万维网服务器。<br>客户程序向服务器程序发出请求，服务器程序向客户程序送回客户所要的万维网文档。<br>在一个客户程序主窗口上显示出的万维网文档称为页面(page)。</p>
<p>(1) 怎样标志分布在整个因特网上的万维网文档？<br>使用统一资源定位符 URL (Uniform Resource Locator)来标志万维网上的各种文档。<br>使每一个文档在整个因特网的范围内具有唯一的标识符 URL。 </p>
<p>(2) 用何协议实现万维网上各种超链的链接？<br><strong>使用超文本传送协议 HTTP (HyperText Transfer Protocol)</strong>在客户程序与服务器程序之间进行交互。<br>HTTP是一个应用层协议，使用 TCP 连接进行可靠的传送。 </p>
<p>(3) 怎样使各种万维网文档能在因特网上的各种计算机上显示出来，同时使用户清楚地知道在什么地方存在着超链？<br>超文本标记语言 HTML (HyperText Markup Language)使得万维网页面的设计者可以很方便地用一个超链从本页面的某处链接到因特网上的任何一个万维网页面，并且能够在自己的计算机屏幕上将这些页面显示出来。 </p>
<p>(4) 怎样使用户能够很方便地找到所需的信息？<br>为了在万维网上方便地查找信息，用户可使用各种的搜索工具（即搜索引擎）。 </p>
<p>统一资源定位符 URL</p>
<ol>
<li>URL的格式<br>统一资源定位符 URL 是对可以从因特网上得到的资源的位置和访问方法的一种简洁的表示。<br>URL 给资源的位置提供一种抽象的识别方法，并用这种方法给资源定位。<br>只要能够对资源定位，系统就可以对资源进行各种操作，如存取、更新、替换和查找其属性。<br>URL 相当于一个文件名在网络范围的扩展。因此 URL 是与因特网相连的机器上的任何可访问对象的一个指针。  </li>
</ol>
<p>由以冒号隔开的两大部分组成，并且在 URL 中的字符对大写或小写没有要求。<br>URL 的一般形式是：<br><img src="/images/132.png" alt=""><br>&lt;主机&gt; 是存放资源的主机在因特网中的域名<br>HTTP 的默认端口号是 80，通常可省略<br>若再省略文件的&lt;路径&gt;项，则 URL 就指到因特网上的某个主页(home page)。 </p>
<ol>
<li>HTTP 的操作过程<br>(1) 浏览器分析超链指向页面的 URL。<br>(2) 浏览器向 DNS 请求解析 <a href="http://www.tsinghua.edu.cn" target="_blank" rel="noopener">www.tsinghua.edu.cn</a> 的 IP 地址。<br>(3) 域名系统 DNS 解析出清华大学服务器的 IP 地址。<br>(4) 浏览器与服务器建立 TCP 连接<br>(5) 浏览器发出取文件命令： GET /chn/yxsz/index.htm。<br>(6) 服务器给出响应，把文件 index.htm 发给浏览器。<br>(7) TCP 连接释放。<br>(8) 浏览器显示“清华大学院系设置”文件 index.htm 中的所有文本。</li>
</ol>
<p>HTTP 是面向事务的客户服务器协议。<br>HTTP 1.0 协议是无状态的(stateless)。<br>HTTP 1.0协议本身也是无连接的，虽然它使用了面向连接的 TCP 向上提供的服务。<br>HTTP/1.1 协议使用持续连接。<br>万维网服务器在发送响应后仍然在一段时间内保持这条连接，使同一个客户（浏览器）和该服务器可以继续在这条连接上传送后续的 HTTP 请求报文和响应报文。<br>这并不局限于传送同一个页面上链接的文档，而是只要这些文档都在同一个服务器上就行。<br><img src="/images/133.png" alt=""><br>持续连接的两种工作方式<br>非流水线方式：客户在收到前一个响应后才能发出下一个请求。这比非持续连接的两倍 RTT 的开销节省了建立 TCP 连接所需的一个 RTT 时间。但服务器在发送完一个对象后，其 TCP 连接就处于空闲状态，浪费了服务器资源。<br>流水线方式：客户在收到 HTTP 的响应报文之前就能够接着发送新的请求报文。一个接一个的请求报文到达服务器后，服务器就可连续发回响应报文。使用流水线方式时，客户访问所有的对象只需花费一个 RTT时间，使 TCP 连接中的空闲时间减少，提高了下载文档效率。 </p>
<p>代理服务器(proxy server)<br>代理服务器(proxy server)又称为万维网高速缓存(Web cache)，它代表浏览器发出 HTTP 请求。<br>万维网高速缓存把最近的一些请求和响应暂存在本地磁盘中。<br>当与暂时存放的请求相同的新请求到达时，万维网高速缓存就把暂存的响应发送出去，而不需要按 URL 的地址再去因特网访问该资源。  </p>
<p>HTTP 有两类报文：<br>请求报文——从客户向服务器发送请求报文。<br>响应报文——从服务器到客户的回答。<br>由于 HTTP 是面向正文的(text-oriented)，因此在报文中的每一个字段都是一些 ASCII 码串，因而每个字段的长度都是不确定的。<br><strong>HTTP 的报文结构(请求报文)</strong><br><img src="/images/134.png" alt=""><br><img src="/images/136.png" alt=""><br><strong>HTTP 的报文结构(响应报文)</strong><br><img src="/images/135.png" alt=""><br>状态码都是三位数字<br>1xx 表示通知信息的，如请求收到了或正在进行处理。<br>2xx 表示成功，如接受或知道了。<br>3xx 表示重定向，表示要完成请求还必须采取进一步的行动。<br>4xx 表示客户的差错，如请求中有错误的语法或不能完成。<br>5xx 表示服务器的差错，如服务器失效无法完成请求。</p>
<ol start="4">
<li>在服务器上存放用户的信息<br>万维网站点使用 Cookie 来跟踪用户。<br>Cookie 表示在 HTTP 服务器和客户之间传递的状态信息。<br>使用 Cookie 的网站服务器为用户产生一个唯一的识别码。利用此识别码，网站就能够跟踪该用户在该网站的活动。  </li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tukuai.github.io/2020/03/15/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%AC%AC%E4%BA%94%E5%B1%82-%E5%BA%94%E7%94%A8%E5%B1%82/" data-id="ckb22iugq00cszwu8btim605y" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="tag">计算机网络</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/7/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/9/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/IO/">IO</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JVM/">JVM</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java%E8%BF%9B%E9%98%B6/">Java进阶</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode/">LeetCode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/">并发编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/">面向对象</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/" rel="tag">JVM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LeetCode/" rel="tag">LeetCode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web/" rel="tag">Web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="tag">计算机网络</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JVM/" style="font-size: 12.86px;">JVM</a> <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/LeetCode/" style="font-size: 11.43px;">LeetCode</a> <a href="/tags/Web/" style="font-size: 18.57px;">Web</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 17.14px;">数据库</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 14.29px;">数据结构</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 15.71px;">算法</a> <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 11.43px;">计算机网络</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 14.29px;">设计模式</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/06/05/%E6%95%B0%E6%8D%AE%E5%BA%93/WHERE%E5%92%8CON%E7%9A%84%E5%8C%BA%E5%88%AB/">数据库/WHERE和ON的区别</a>
          </li>
        
          <li>
            <a href="/2020/06/05/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%B5%8B%E8%AF%95/">操作系统/测试</a>
          </li>
        
          <li>
            <a href="/2020/06/05/Java%E5%9F%BA%E7%A1%80/HashMap/">Java基础/HashMap</a>
          </li>
        
          <li>
            <a href="/2020/05/23/Redis/%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">企业级解决方案</a>
          </li>
        
          <li>
            <a href="/2020/05/23/Redis/Redis%E9%9B%86%E7%BE%A4/">Redis集群</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Tukuai<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>